{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\game.js"],"names":["cc","Class","extends","Component","properties","paiPrefab","default","type","Prefab","spriteFrames","SpriteFrame","tutorial","Node","startButton","Button","_paiSprites","_pais","rows","columns","paiWidth","paiHeight","paddingLeft","paddingTop","solutionx1","solutiony1","solutionx2","solutiony2","suggestionTimer","_lastPai","lastX","lastY","moveDirection","moveStart","moveEnd","moveMin","moveMax","originalX","originalY","mouseDown","count","coward","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","event","keyCode","macro","KEY","n","getComponent","i","index","x","y","color","Color","WHITE","onDestroy","pais","j","sys","localStorage","setItem","log","onGameStart","Array","self","newNode","instantiate","Sprite","spriteFrame","Math","trunc","node","addChild","setPosition","v2","TOUCH_END","onTouchEnd","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","paisStorage","getItem","split","shuffle","active","enabled","visable","highLightSolution","width","height","setTimeout","stopHighLightSolution","diedGame","livePai","map","pai","t","o","push","staticLiveGame","delta","c","k","temp","mode","centerx","centery","offset","key","length","connected","adjustPosition","x1","y1","x2","y2","small","big","adjusted1","adjusted2","toString","row","column","zIndex","currentPai","floor","getLocationY","getLocationX","currentX","currentY","match","lowX","min","lowY","highX","max","highY","random","runAction","winSplash","reshuffle","clearTimeout","GRAY","getDelta","location","getLocation","abs","round","matchFound","switchPai","tempType","tempX","tempY","targetType","targetX","targetY","indexes","array","m","init","moveTo","start","moveBy","easing","easeCubicActionOut","scaleUp","scaleTo","move","scaleDown","end","repeatForever","sequence"],"mappings":"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","file":"game.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        paiPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        spriteFrames: {\r\n            default: [],\r\n            type: [cc.SpriteFrame]\r\n        },\r\n\r\n        tutorial: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        startButton: {\r\n            default: null,\r\n            type: cc.Button\r\n        },\r\n        _paiSprites: {\r\n            default: [],\r\n            type: [cc.Node]\r\n        },\r\n\r\n        _pais: null,\r\n\r\n        rows: 8,\r\n        columns: 17,\r\n\r\n        paiWidth: 60,\r\n        paiHeight: 90,\r\n\r\n        paddingLeft: 640,\r\n        paddingTop: 360,\r\n        solutionx1: -1,\r\n        solutiony1: -1,\r\n        solutionx2: -1,\r\n        solutiony2: -1,\r\n        suggestionTimer: null,\r\n\r\n        _lastPai: null,\r\n        lastX: 0,\r\n        lastY: 0,\r\n\r\n        moveDirection: -1,\r\n        moveStart: 0,\r\n        moveEnd: 0,\r\n        moveMin: 0,\r\n        moveMax: 0,\r\n        originalX: 0,\r\n        originalY: 0,\r\n\r\n        mouseDown: false,\r\n        count: 0,\r\n\r\n        coward: false\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this)\r\n    },\r\n\r\n    onKeyDown (event) {\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.n:\r\n                if (this.coward && this._lastPai != null && this._lastPai.getComponent('Pai').type != -1) {\r\n                    for (var i = 0; i < 4; i++) {\r\n                        var index = this._pais[this._lastPai.getComponent('Pai').type  * 4 + i]\r\n                        if (index != null) {\r\n                            this._paiSprites[index.x][index.y].color = cc.Color.WHITE\r\n                        }\r\n                    }\r\n                }\r\n                this.coward = !this.coward\r\n                break\r\n        }\r\n    },\r\n\r\n    onDestroy () {\r\n        var pais = \"\"\r\n        for (var i = 0; i < this.rows; i++) {\r\n            for (var j = 0; j < this.columns; j++) {\r\n                pais += this._paiSprites[i][j].getComponent('Pai').type + \" \"\r\n            }\r\n        }\r\n        cc.sys.localStorage.setItem('pais', pais)\r\n        cc.log('save state')\r\n    },\r\n\r\n    onGameStart () {\r\n        this._pais = new Array(this.rows * this.columns)\r\n        this._paiSprites = new Array(this.rows)\r\n        for (var i = 0; i < this.rows; i++) {\r\n            this._paiSprites[i] = new Array(this.columns)\r\n            for (var j = 0; j < this.columns; j++) {\r\n                this._paiSprites[i][j] = null\r\n            }\r\n        }\r\n\r\n        var self = this\r\n        for (var i = 0; i < this.rows; i++) {\r\n            for (var j = 0; j < this.columns; j++) {\r\n                var newNode = cc.instantiate(this.paiPrefab)\r\n                newNode.getComponent(cc.Sprite).spriteFrame = this.spriteFrames[Math.trunc((i * this.rows + j) / 4)]\r\n                this._paiSprites[i][j] = newNode\r\n                this.node.addChild(newNode)\r\n                newNode.setPosition(cc.v2(this.paiWidth * j - this.paddingLeft, this.paiHeight * i - this.paddingTop))\r\n            }\r\n        }\r\n        this.node.on(cc.Node.EventType.TOUCH_END, function(event) {\r\n            this.onTouchEnd(event, self)\r\n        }, this)\r\n        this.node.on(cc.Node.EventType.TOUCH_START, function(event) {\r\n            this.onTouchStart(event, self)\r\n        }, this)\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, function(event) {\r\n            this.onTouchMove(event, self)\r\n        }, this)\r\n\r\n        var paisStorage = cc.sys.localStorage.getItem('pais')\r\n        if (paisStorage != null) {\r\n            var pais = paisStorage.split(' ')\r\n            for (var i = 0; i < this.rows; i++) {\r\n                for (var j = 0; j < this.columns; j++) {\r\n                    this._paiSprites[i][j].getComponent(cc.Sprite).spriteFrame = this.spriteFrames[pais[i * columns + j] == -1 ? 34 : pais[i * columns + j]]\r\n                    this._paiSprites[i][j].getComponent('Pai').type = pais[i * columns + j]\r\n                }\r\n            }\r\n        } else {\r\n            this.shuffle()\r\n        }\r\n        this.tutorial.active = false\r\n        this.startButton.active = false\r\n        this.startButton.enabled = false\r\n        this.startButton.visable = false\r\n    },\r\n    highLightSolution() {\r\n        if (this.solutionx1 >= 0 && this.solutionx2 >= 0 && this.solutiony1 >= 0 && this.solutiony2 >= 0) {\r\n            this._paiSprites[this.solutionx1][this.solutiony1].width = this.paiWidth + 15;\r\n            this._paiSprites[this.solutionx1][this.solutiony1].height = this.paiHeight + 15;\r\n            this._paiSprites[this.solutionx2][this.solutiony2].width = this.paiWidth + 15;\r\n            this._paiSprites[this.solutionx2][this.solutiony2].height = this.paiHeight + 15;\r\n        }\r\n        setTimeout(() => {this.stopHighLightSolution()}, 300);\r\n    },\r\n    stopHighLightSolution() {\r\n        if (this.solutionx1 >= 0 && this.solutionx2 >= 0 && this.solutiony1 >= 0 && this.solutiony2 >= 0) {\r\n            this._paiSprites[this.solutionx1][this.solutiony1].width = this.paiWidth;\r\n            this._paiSprites[this.solutionx1][this.solutiony1].height = this.paiHeight;\r\n            this._paiSprites[this.solutionx2][this.solutiony2].width = this.paiWidth;\r\n            this._paiSprites[this.solutionx2][this.solutiony2].height = this.paiHeight;\r\n        }\r\n    },\r\n\r\n    diedGame() {\r\n        var livePai = {}\r\n        var map = new Array(this.rows);\r\n\r\n        for (var i = 0; i < this.rows; i++) {\r\n            map[i] = [];\r\n            for (var j = 0; j < this.columns; j++) {\r\n                var pai = this._paiSprites[i][j].getComponent('Pai');\r\n                var t = pai.type;\r\n                var o = {type: t, x: i, y: j};\r\n                map[i].push(o);\r\n                if (t == -1) {\r\n                    continue;\r\n                }\r\n\r\n                if (t in livePai) {\r\n                    livePai[t].push(o);\r\n                } else {\r\n                    livePai[t] = [o];\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.staticLiveGame(map, livePai, 0, 0, 0, 0)) {\r\n            return false;\r\n        }\r\n\r\n        for (var i = 0; i < this.rows; i++) {\r\n            for (var j = 0; j < this.columns; j++) {\r\n                if (map[i][j].type != -1) {\r\n                    continue;\r\n                }\r\n\r\n                // ======================\r\n                // try to move left pais to current location\r\n                var x = i - 1;\r\n                while(x>-1 && map[x][j].type < 0) {\r\n                    x--;\r\n                }\r\n\r\n                // if x >= 0, that mean there is pai on left can be moved\r\n                if (x >= 0) {\r\n                    var delta = i - x;\r\n                    var c = 0;\r\n                    while((x-c)>=0 && map[x-c][j].type >= 0) {\r\n                        c++;\r\n                    }\r\n\r\n                    // move pai\r\n                    for(var k=0;k<c;k++) {\r\n                        var temp = map[i-k][j];\r\n                        map[i-k][j] = map[x-k][j];\r\n                        map[i-k][j].x = i-k;\r\n                        map[x-k][j] = temp;\r\n                        map[x-k][j].x = x-k;\r\n                    }\r\n\r\n                    if(this.staticLiveGame(map, livePai, 1, i, j, delta, c)) {\r\n                        return false;\r\n                    }\r\n\r\n                    // resume pai\r\n                    for(var k = c-1; k >= 0; k--) {\r\n                        var temp = map[i-k][j];\r\n                        map[i-k][j] = map[x-k][j];\r\n                        map[i-k][j].x = i-k;\r\n                        map[x-k][j] = temp;\r\n                        map[x-k][j].x = x-k;\r\n                    }\r\n                    \r\n                }\r\n                // ====================\r\n                // try to move right pais to current location\r\n                x = i + 1;\r\n                while(x < this.rows && map[x][j].type < 0) {\r\n                    x++;\r\n                }\r\n\r\n                // if x < columns, that mean there is pai on right can be moved\r\n                if (x < this.rows) {\r\n                    var delta = x - i;\r\n                    var c = 0;\r\n                    while((x+c) < this.rows && map[x+c][j].type >= 0) {\r\n                        c++;\r\n                    }\r\n\r\n                    // move pai\r\n                    for(var k=0;k<c;k++) {\r\n                        var temp = map[i+k][j];\r\n                        map[i+k][j] = map[x+k][j];\r\n                        map[i+k][j].x = i+k;\r\n                        map[x+k][j] = temp;\r\n                        map[x+k][j].x = x+k;\r\n                    }\r\n\r\n                    if(this.staticLiveGame(map, livePai, 2, i, j, delta, c)) {\r\n                        return false;\r\n                    }\r\n\r\n                    // resume pai\r\n                    for(var k = c-1; k >= 0; k--) {\r\n                        var temp = map[i+k][j];\r\n                        map[i+k][j] = map[x+k][j];\r\n                        map[i+k][j].x = i+k;\r\n                        map[x+k][j] = temp;\r\n                        map[x+k][j].x = x+k;\r\n                    }\r\n                    \r\n                }\r\n\r\n                // ====================================\r\n                x = j - 1;\r\n                while(x > -1 && map[i][x].type < 0) {\r\n                    x--;\r\n                }\r\n\r\n                // if x >= 0, that mean there is pai  can be moved\r\n                if (x >= 0) {\r\n                    var delta = j - x;\r\n                    var c = 0;\r\n                    while((x-c)>=0 && map[i][x-c].type >= 0) {\r\n                        c++;\r\n                    }\r\n\r\n                    // move pai\r\n                    for(var k=0;k<c;k++) {\r\n                        var temp = map[i][j-k];\r\n                        map[i][j-k] = map[i][x-k];\r\n                        map[i][j-k].y = j-k;\r\n                        map[i][x-k] = temp;\r\n                        map[i][x-k].y = x-k;\r\n                    }\r\n\r\n                    if(this.staticLiveGame(map, livePai, 3, i, j, delta, c)) {\r\n                        return false;\r\n                    }\r\n\r\n                    // resume pai\r\n                    for(var k = c-1; k >= 0; k--) {\r\n                        var temp = map[i][j-k];\r\n                        map[i][j-k] = map[i][x-k];\r\n                        map[i][j-k].y = j-k;\r\n                        map[i][x-k] = temp;\r\n                        map[i][x-k].y = x-k;\r\n                    }\r\n                    \r\n                }\r\n                // ====================\r\n                // try to move right pais to current location\r\n                x = j + 1;\r\n                while(x < this.columns && map[i][x].type < 0) {\r\n                    x++;\r\n                }\r\n\r\n                // if x < columns, that mean there is pai on right can be moved\r\n                if (x < this.columns) {\r\n                    var delta = x - j;\r\n                    var c = 0;\r\n                    while((x+c) < this.columns && map[i][x+c].type >= 0) {\r\n                        c++;\r\n                    }\r\n\r\n                    // move pai\r\n                    for(var k=0;k<c;k++) {\r\n                        var temp = map[i][j+k];\r\n                        map[i][j+k] = map[i][x+k];\r\n                        map[i][j+k].y = j+k;\r\n                        map[i][x+k] = temp;\r\n                        map[i][x+k].y = x+k;\r\n                    }\r\n\r\n                    if(this.staticLiveGame(map, livePai, 4, i, j, delta, c)) {\r\n                        return false;\r\n                    }\r\n\r\n                    // resume pai\r\n                    for(var k = c-1; k >= 0; k--) {\r\n                        var temp = map[i][j+k];\r\n                        map[i][j+k] = map[i][x+k];\r\n                        map[i][j+k].y = j+k;\r\n                        map[i][x+k] = temp;\r\n                        map[i][x+k].y = x+k;\r\n                    }\r\n                    \r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n    // check map, if there steps available\r\n    staticLiveGame(map, livePai, mode, centerx, centery, offset, count) {\r\n        for(var key in livePai) {\r\n            var pais = livePai[key];\r\n            for(var i=0;i<pais.length-1;i++) {\r\n                for(var j=i+1;j<pais.length;j++) {\r\n                    if (this.connected(map, pais[i].x, pais[i].y, pais[j].x, pais[j].y, mode, centerx, centery, offset, count)) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    adjustPosition(x, y, mode, centerx, centery, offset, count) {\r\n        if (mode == 1) {\r\n            if (y == centery) {\r\n                if (x <= centerx && x >= (centerx-count)) {\r\n                    return [x - offset, y];\r\n                }\r\n            }\r\n        }\r\n\r\n        if (mode == 2) {\r\n            if (y == centery) {\r\n                if (x <= (centerx + count) && x >= centerx) {\r\n                    return [x + offset, y];\r\n                }\r\n            }\r\n        }\r\n\r\n        if (mode == 3) {\r\n            if (x == centerx) {\r\n                if (y < centery && y >= centery - count) {\r\n                    return [x, y - offset];\r\n                }\r\n            }\r\n        }\r\n\r\n        if (mode == 4) {\r\n            if (x == centerx) {\r\n                if (y <= (centery + count) && y >= centery) {\r\n                    return [x, y + offset];\r\n                }\r\n            }\r\n        }\r\n\r\n        return [x, y];\r\n    },\r\n    connected(map, x1, y1, x2, y2, mode, centerx, centery, offset, count) {\r\n        if (x1 == x2) {\r\n            var small = y1;\r\n            var big = y2;\r\n            if (y1 > y2) {\r\n                small = y2;\r\n                big = y1;\r\n            }\r\n\r\n            for (var i = small+1; i < big; i++ )\r\n            {\r\n                if (map[x1][i].type != -1) {\r\n                    return false;\r\n                }\r\n            }\r\n            var adjusted1 = this.adjustPosition(x1, y1, mode, centerx, centery, offset, count);\r\n            var adjusted2 = this.adjustPosition(x2, y2, mode, centerx, centery, offset, count);\r\n            this.solutionx1 = adjusted1[0];\r\n            this.solutiony1 = adjusted1[1];\r\n            this.solutionx2 = adjusted2[0];\r\n            this.solutiony2 = adjusted2[1];\r\n            cc.log(\"connected: \" + adjusted1[0].toString() + \", \" + adjusted1[1].toString() + \"; \" + adjusted2[0].toString() + \", \" + adjusted2[1].toString())\r\n            return true;\r\n        }\r\n\r\n        if (y1 == y2) {\r\n            var small = x1;\r\n            var big = x2;\r\n            if (x1 > x2) {\r\n                small = x2;\r\n                big = x1;\r\n            }\r\n\r\n            for (var i = small+1; i < big; i++ )\r\n            {\r\n                if (map[i][y1].type != -1) {\r\n                    return false;\r\n                }\r\n            }\r\n            var adjusted1 = this.adjustPosition(x1, y1, mode, centerx, centery, offset, count);\r\n            var adjusted2 = this.adjustPosition(x2, y2, mode, centerx, centery, offset, count);\r\n            this.solutionx1 = adjusted1[0];\r\n            this.solutiony1 = adjusted1[1];\r\n            this.solutionx2 = adjusted2[0];\r\n            this.solutiony2 = adjusted2[1];\r\n            cc.log(\"connected: \" + adjusted1[0].toString() + \", \" + adjusted1[1].toString() + \"; \" + adjusted2[0].toString() + \", \" + adjusted2[1].toString())\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    onTouchStart (event, self) {\r\n        if (self.mouseDown === true && self._lastPai != null) {\r\n            var row = self._lastPai.getComponent('Pai').x\r\n            var column = self._lastPai.getComponent('Pai').y\r\n            if (self.moveDirection === 0) {\r\n                for (var j = self.moveStart; j <= self.moveEnd; j++) {\r\n                    self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\r\n                    self._paiSprites[row][j].zIndex = 0\r\n                }\r\n            } else if (self.moveDirection === 1) {\r\n                for (var i = self.moveStart; i <= self.moveEnd; i++) {\r\n                    self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\r\n                    self._paiSprites[i][column].zIndex = 0\r\n                }\r\n            }\r\n        }\r\n        self.mouseDown = true\r\n        var currentPai = self._paiSprites[Math.floor(event.getLocationY() / this.paiHeight)][Math.floor(event.getLocationX() / this.paiWidth)]\r\n        if (self._lastPai != null) {\r\n            self._lastPai.color = cc.Color.WHITE\r\n            if (self.coward && self._lastPai.getComponent('Pai').type != -1) {\r\n                for (var i = 0; i < 4; i++) {\r\n                    var index = self._pais[self._lastPai.getComponent('Pai').type  * 4 + i]\r\n                    if (index != null) {\r\n                        self._paiSprites[index.x][index.y].color = cc.Color.WHITE\r\n                    }\r\n                }\r\n            }\r\n            if (currentPai.getComponent('Pai').type === self._lastPai.getComponent('Pai').type && self._lastPai.getComponent('Pai').type != -1 && currentPai != self._lastPai) {\r\n                var currentX = currentPai.getComponent('Pai').x\r\n                var currentY = currentPai.getComponent('Pai').y\r\n                var lastX = self._lastPai.getComponent('Pai').x\r\n                var lastY = self._lastPai.getComponent('Pai').y\r\n\r\n                cc.log(\"current: \" + currentX + \",\" + currentY)\r\n                cc.log(\"last: \" + lastX + \",\" + lastY)\r\n                var match = true\r\n                var lowX = Math.min(currentX, lastX)\r\n                var lowY = Math.min(currentY, lastY)\r\n                var highX = Math.max(currentX, lastX)\r\n                var highY = Math.max(currentY, lastY)\r\n\r\n                if ((currentX < lastX && currentY < lastY) || (currentX >= lastX && currentY >= lastY)) {\r\n                    cc.log(\"a\")\r\n                    for (var i = lowX + 1; i <= highX; i++) {\r\n                        cc.log(\"a1: \" + i + \",\" + lowY + \":\" + self._paiSprites[i][lowY].getComponent('Pai').type)\r\n                        if (i != highX && self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\r\n                            match = false\r\n                            break\r\n                        }\r\n                    }\r\n\r\n                    if (match) {\r\n                        for (var j = lowY; j < highY; j++) {\r\n                            cc.log(\"a2: \" + highX + \",\" + j + \":\" + self._paiSprites[highX][j].getComponent('Pai').type)\r\n                            if (self._paiSprites[highX][j].getComponent('Pai').type != -1) {\r\n                                match = false\r\n                                break\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (!match) {\r\n                        match = true\r\n                        for (var j = lowY + 1; j <= highY; j++) {\r\n                            cc.log(\"a3: \" + lowX + \",\" + j + \":\" + self._paiSprites[lowX][j].getComponent('Pai').type)\r\n                            if (j != highY && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\r\n                                match = false\r\n                                break\r\n                            }\r\n                        }\r\n\r\n                        if (match) {\r\n                            for (var i = lowX; i < highX; i++) {\r\n                                cc.log(\"a4: \" + i + \",\" + highY + \":\" + self._paiSprites[i][highY].getComponent('Pai').type)\r\n                                if (self._paiSprites[i][highY].getComponent('Pai').type != -1) {\r\n                                    match = false\r\n                                    break\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                } else if ((currentX >= lastX && currentY < lastY) || (currentX < lastX && currentY >= lastY)) {\r\n                    cc.log(\"b\")\r\n                    for (var i = lowX + 1; i <= highX; i++) {\r\n                        cc.log(\"b1: \" + i + \",\" + highY + \":\" + self._paiSprites[i][highY].getComponent('Pai').type)\r\n                        if (i != highX && self._paiSprites[i][highY].getComponent('Pai').type != -1) {\r\n                            match = false\r\n                            break\r\n                        }\r\n                    }\r\n\r\n                    if (match) {\r\n                        for (var j = highY; j > lowY; j--) {\r\n                            cc.log(\"b2: \" + highX + \",\" + j + \":\" + self._paiSprites[highX][j].getComponent('Pai').type)\r\n                            if (self._paiSprites[highX][j].getComponent('Pai').type != -1) {\r\n                                match = false\r\n                                break\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (!match) {\r\n                        match = true\r\n                        for (var j = highY - 1; j >= lowY; j--) {\r\n                            cc.log(\"b3: \" + lowX + \",\" + j + \":\" + self._paiSprites[lowX][j].getComponent('Pai').type)\r\n                            if (j != lowY && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\r\n                                match = false\r\n                                break\r\n                            }\r\n                        }\r\n\r\n                        if (match) {\r\n                            for (var i = lowX; i < highX; i++) {\r\n                                cc.log(\"b4: \" + i + \",\" + lowY + \":\" + self._paiSprites[i][lowY].getComponent('Pai').type)\r\n                                if (self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\r\n                                    match = false\r\n                                    break\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                if (match) {\r\n                    currentPai.getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\r\n                    currentPai.width = this.paiWidth\r\n                    currentPai.height = this.paiHeight\r\n                    self._lastPai.getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\r\n                    self._lastPai.width = this.paiWidth\r\n                    self._lastPai.height = this.paiHeight\r\n                    currentPai.getComponent('Pai').type = -1\r\n                    self._lastPai.getComponent('Pai').type = -1\r\n                    self._pais[self._lastPai.index] = null\r\n                    self._pais[currentPai.index] = null\r\n                    currentPai.color = cc.Color.WHITE\r\n                    \r\n                    self.count += 2\r\n                    if (self.count >= self.rows * self.columns) {\r\n                        for (var i = 0; i < this.rows; i++) {\r\n                            for (var j = 0; j < this.columns; j++) {\r\n                                self._paiSprites[i][j].getComponent(cc.Sprite).spriteFrame = this.spriteFrames[Math.trunc(Math.random() * 35)]\r\n                                self._paiSprites[i][j].runAction(self.winSplash())\r\n                            }\r\n                        }\r\n                    } else {\r\n                        cc.log(\"Check died game:\");\r\n                        while(this.diedGame()) {\r\n                            this.reshuffle();\r\n                        }\r\n                        clearTimeout(this.suggestionTimer);\r\n                        this.suggestionTimer = setTimeout(\r\n                            () => { \r\n                                this.highLightSolution(); \r\n                            }\r\n                            , 2000);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        currentPai.color = cc.Color.GRAY\r\n        self._lastPai = currentPai\r\n        if (self.coward && currentPai.getComponent('Pai').type != -1) {\r\n            for (var i = 0; i < 4; i++) {\r\n                var index = self._pais[currentPai.getComponent('Pai').type * 4 + i]\r\n                if (index != null && self._paiSprites[index.x][index.y].getComponent('Pai').type != -1) {\r\n                    self._paiSprites[index.x][index.y].color = cc.Color.GRAY\r\n                }\r\n            }\r\n        }\r\n        self.originalX = currentPai.getComponent('Pai').x\r\n        self.originalY = currentPai.getComponent('Pai').y\r\n    },\r\n\r\n    onTouchMove (event, self) {\r\n        var delta = event.getDelta()\r\n        var location = event.getLocation()\r\n        if (self._lastPai != null && self._lastPai.getComponent('Pai').type != -1) {\r\n            var x = self._lastPai.getComponent('Pai').x\r\n            var y = self._lastPai.getComponent('Pai').y\r\n            if (self.moveDirection === -1) {\r\n                if (Math.abs(delta.x) > Math.abs(delta.y)) {\r\n                    self.moveDirection = 0\r\n                    if (y === 0) {\r\n                        self.moveStart = 0\r\n                        self.moveMin = 0\r\n                    } else {\r\n                        var i = y - 1\r\n                        while (i >= 0 && self._paiSprites[x][i].getComponent('Pai').type != -1) {\r\n                            i--\r\n                        }\r\n                        self.moveStart = i + 1\r\n                        while (i >= 0 && self._paiSprites[x][i].getComponent('Pai').type === -1) {\r\n                            i--\r\n                        }\r\n                        self.moveMin = i + 1\r\n                    }\r\n                    if (y === self.columns - 1) {\r\n                        self.moveEnd = self.columns - 1\r\n                        self.moveMax = self.columns - 1\r\n                    } else {\r\n                        var i = y + 1\r\n                        while (i < self.columns && self._paiSprites[x][i].getComponent('Pai').type != -1) {\r\n                            i++\r\n                        }\r\n                        self.moveEnd = i - 1\r\n                        while (i < self.columns && self._paiSprites[x][i].getComponent('Pai').type === -1) {\r\n                            i++\r\n                        }\r\n                        self.moveMax = i - 1\r\n                    }\r\n                    for (var j = self.moveStart; j <= self.moveEnd; j++) {\r\n                        self._paiSprites[x][j].zIndex = 1000\r\n                    }\r\n                } else {\r\n                    self.moveDirection = 1\r\n                    if (x === 0) {\r\n                        self.moveStart = 0\r\n                        self.moveMin = 0\r\n                    } else {\r\n                        var i = x - 1\r\n                        while (i >= 0 && self._paiSprites[i][y].getComponent('Pai').type != -1) {\r\n                            i--\r\n                        }\r\n                        self.moveStart = i + 1\r\n                        while (i >= 0 && self._paiSprites[i][y].getComponent('Pai').type === -1) {\r\n                            i--\r\n                        }\r\n                        self.moveMin = i + 1\r\n                    }\r\n                    if (x === self.rows - 1) {\r\n                        self.moveEnd = self.rows - 1\r\n                    } else {\r\n                        var i = x + 1\r\n                        while (i < self.rows && self._paiSprites[i][y].getComponent('Pai').type != -1) {\r\n                            i++\r\n                        }\r\n                        self.moveEnd = i - 1\r\n                        while (i < self.rows && self._paiSprites[i][y].getComponent('Pai').type === -1) {\r\n                            i++\r\n                        }\r\n                        self.moveMax = i - 1\r\n                    }\r\n                    for (var i = self.moveStart; i <= self.moveEnd; i++) {\r\n                        self._paiSprites[i][y].zIndex = 1000\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (self.moveDirection === 0) {\r\n                var row = self._lastPai.getComponent('Pai').x\r\n                if ((delta.x > 0 && self._paiSprites[row][self.moveEnd].x + delta.x <= self.moveMax * self.paiWidth - self.paddingLeft)\r\n                    || (delta.x < 0 && self._paiSprites[row][self.moveStart].x + delta.x >= self.moveMin * self.paiWidth - self.paddingLeft)) {\r\n                    for (var j = self.moveStart; j <= self.moveEnd; j++) {\r\n                        self._paiSprites[row][j].x += delta.x\r\n                        self._paiSprites[row][j].zIndex = 1000\r\n                    }\r\n                }\r\n            } else {\r\n                var column = self._lastPai.getComponent('Pai').y\r\n                if ((delta.y > 0 && self._paiSprites[self.moveEnd][column].y + delta.y <= self.moveMax * self.paiHeight - self.paddingTop)\r\n                    || (delta.y < 0 && self._paiSprites[self.moveStart][column].y + delta.y >= self.moveMin * self.paiHeight - self.paddingTop)) {\r\n                    for (var i = self.moveStart; i <= self.moveEnd; i++) {\r\n                        self._paiSprites[i][column].y += delta.y\r\n                        self._paiSprites[i][column].zIndex = 1000\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    onTouchEnd (event, self) {\r\n        cc.log('touchEnd: ')\r\n        self.mouseDown = false\r\n        if (self.moveDirection === 0) {\r\n            var row = self._lastPai.getComponent('Pai').x\r\n            var column = self._lastPai.getComponent('Pai').y\r\n            var currentX = Math.round((self._lastPai.x + this.paddingLeft) / self.paiWidth)\r\n            var delta = currentX - column\r\n            var matchFound = false\r\n            // cc.log('column: ' + column)\r\n            // cc.log('currentX: ' + currentX)\r\n            // cc.log('delta: '  + delta)\r\n            if (delta > 0) {\r\n                for (var j = self.moveStart; j <= self.moveEnd + delta; j++) {\r\n                    if (j < self.moveStart + delta && row != self.rows - 1 && row != 0) {\r\n                        var highX = row + 1\r\n                        while (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type === -1) {\r\n                            highX++\r\n                        }\r\n                        var lowX = row - 1\r\n                        while (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === -1) {\r\n                            lowX--\r\n                        }\r\n                        //cc.log('lowX: ' + lowX)\r\n                        //cc.log('highX: ' + highX + \", j: \" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\r\n                        //cc.log('lowX: ' + lowX + \", j: \" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\r\n                        if (lowX >= 0 && highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type === self._paiSprites[lowX][j].getComponent('Pai').type\r\n                            && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\r\n                            matchFound = true\r\n                            break\r\n                        }\r\n                    }\r\n                    if (j >= self.moveStart + delta) {\r\n                        if (row != self.rows - 1) {\r\n                            var highX = row + 1\r\n                            while (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type === -1) {\r\n                                highX++\r\n                            }\r\n                            //cc.log('highX: ' + highX + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\r\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\r\n                            if (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type == self._paiSprites[row][j - delta].getComponent('Pai').type\r\n                                && self._paiSprites[highX][j].getComponent('Pai').type != -1) {\r\n                                    matchFound = true\r\n                                    break\r\n                            }\r\n                        }\r\n                        if (row != 0) {\r\n                            var lowX = row - 1\r\n                            while (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === -1) {\r\n                                lowX--\r\n                            }\r\n                            //cc.log('lowX: ' + lowX + \", j: \" + \"\" + j)\r\n                            //cc.log('lowX: ' + lowX + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\r\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\r\n                            if (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === self._paiSprites[row][j - delta].getComponent('Pai').type\r\n                                && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\r\n                                matchFound = true\r\n                                break\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                cc.log(\"matchFound: \" + matchFound)\r\n                if (matchFound) {\r\n                    for (var j = self.moveEnd; j >= self.moveStart; j--) {\r\n                        //cc.log(\"x: \" + row + \", y: \" + (j + delta) + \", from: \" + self._paiSprites[row][j + delta].getComponent('Pai').type + \", to: \" + self._paiSprites[row][j].getComponent('Pai').type)\r\n                        var type = self._paiSprites[row][j].getComponent('Pai').type\r\n                        self._paiSprites[row][j + delta].getComponent('Pai').type = type\r\n                        self._paiSprites[row][j + delta].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[type]\r\n                        self._paiSprites[row][j + delta].index = self._paiSprites[row][j].index\r\n                        self._paiSprites[row][j + delta].width = self.paiWidth\r\n                        self._paiSprites[row][j + delta].height = self.paiHeight\r\n                        self._pais[self._paiSprites[row][j].index] = cc.v2(row, j + delta)\r\n                        if (j < self.moveStart + delta) {\r\n                            self._paiSprites[row][j].getComponent('Pai').type = -1\r\n                            self._paiSprites[row][j].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\r\n                        }\r\n                        //cc.log('set row: ' + row + ', j: ' + j + \" to \" + self._paiSprites[row][j].getComponent('Pai').x)\r\n                        self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\r\n                        self._paiSprites[row][j].zIndex = 0\r\n                        self._paiSprites[row][j].width = self.paiWidth\r\n                        self._paiSprites[row][j].height = self.paiHeight\r\n                    }\r\n                    self._lastPai.color = cc.Color.WHITE\r\n                    self._lastPai = self._paiSprites[row][currentX]\r\n                    self._lastPai.color = cc.Color.GRAY\r\n                    if (self.coward) {\r\n                        for (var i = 0; i < 4; i++) {\r\n                            var index = self._pais[self._lastPai.getComponent('Pai').type * 4 + i]\r\n                            if (index != null) {\r\n                                self._paiSprites[index.x][index.y].color = cc.Color.GRAY\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    for (var j = self.moveStart; j <= self.moveEnd; j++) {\r\n                        self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\r\n                        self._paiSprites[row][j].zIndex = 0\r\n                    }\r\n                }\r\n            } else if (delta < 0) {\r\n                for (var j = self.moveStart + delta; j <= self.moveEnd; j++) {\r\n                    if (j > self.moveEnd + delta && row != self.rows - 1 && row != 0) {\r\n                        var highX = row + 1\r\n                        while (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type === -1) {\r\n                            highX++\r\n                        }\r\n                        var lowX = row - 1\r\n                        while (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === -1) {\r\n                            lowX--\r\n                        }\r\n                        //cc.log('lowX: ' + lowX)\r\n                        //cc.log('highX: ' + highX + \", j: \" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\r\n                        //cc.log('lowX: ' + lowX + \", j: \" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\r\n                        if (highX < self.rows && lowX >= 0 && self._paiSprites[highX][j].getComponent('Pai').type === self._paiSprites[lowX][j].getComponent('Pai').type\r\n                            && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\r\n                            matchFound = true\r\n                            break\r\n                        }\r\n                    }\r\n                    if (j <= self.moveEnd + delta) {\r\n                        if (row != self.rows - 1) {\r\n                            var highX = row + 1\r\n                            \r\n                            while (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type === -1) {\r\n                                cc.log(highX.toString() + \", \" + j);\r\n                                highX++\r\n                            }\r\n                            //cc.log('highX: ' + highX + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\r\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\r\n                            if (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type == self._paiSprites[row][j - delta].getComponent('Pai').type\r\n                                && self._paiSprites[highX][j].getComponent('Pai').type != -1) {\r\n                                    matchFound = true\r\n                                    break\r\n                            }\r\n                        }\r\n                        if (row != 0) {\r\n                            var lowX = row - 1\r\n                            while (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === -1) {\r\n                                lowX--\r\n                            }\r\n                            //cc.log('lowX: ' + lowX + \", j: \" + \"\" + j)\r\n                            //cc.log('lowX: ' + lowX + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\r\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\r\n                            if (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === self._paiSprites[row][j - delta].getComponent('Pai').type\r\n                                && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\r\n                                matchFound = true\r\n                                break\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                cc.log(\"matchFound: \" + matchFound)\r\n                if (matchFound) {\r\n                    for (var j = self.moveStart; j <= self.moveEnd; j++) {\r\n                        //cc.log(\"x: \" + row + \", y: \" + (j + delta) + \", from: \" + self._paiSprites[row][j + delta].getComponent('Pai').type + \", to: \" + self._paiSprites[row][j].getComponent('Pai').type)\r\n                        var type = self._paiSprites[row][j].getComponent('Pai').type\r\n                        self._paiSprites[row][j + delta].getComponent('Pai').type = type\r\n                        self._paiSprites[row][j + delta].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[type]\r\n                        self._paiSprites[row][j + delta].index = self._paiSprites[row][j].index\r\n                        self._paiSprites[row][j + delta].width = self.paiWidth\r\n                        self._paiSprites[row][j + delta].height = self.paiHeight\r\n                        self._pais[self._paiSprites[row][j].index] = cc.v2(row, j + delta)\r\n                        if (j > self.moveEnd + delta) {\r\n                            self._paiSprites[row][j].getComponent('Pai').type = -1\r\n                            self._paiSprites[row][j].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\r\n                        }\r\n                        //cc.log('set row: ' + row + ', j: ' + j + \" to \" + self._paiSprites[row][j].getComponent('Pai').x)\r\n                        self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\r\n                        self._paiSprites[row][j].zIndex = 0\r\n                        self._paiSprites[row][j].width = self.paiWidth\r\n                        self._paiSprites[row][j].height = self.paiHeight\r\n                    }\r\n                    self._lastPai.color = cc.Color.WHITE\r\n                    self._lastPai = self._paiSprites[row][currentX]\r\n                    self._lastPai.color = cc.Color.GRAY\r\n                    if (self.coward) {\r\n                        for (var i = 0; i < 4; i++) {\r\n                            var index = self._pais[self._lastPai.getComponent('Pai').type * 4 + i]\r\n                            if (index != null) {\r\n                                self._paiSprites[index.x][index.y].color = cc.Color.GRAY\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    for (var j = self.moveStart; j <= self.moveEnd; j++) {\r\n                        self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\r\n                        self._paiSprites[row][j].zIndex = 0\r\n                    }\r\n                }\r\n            } else {\r\n                for (var j = self.moveStart; j <= self.moveEnd; j++) {\r\n                    self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\r\n                    self._paiSprites[row][j].zIndex = 0\r\n                }\r\n            }\r\n        } else if (self.moveDirection === 1) {\r\n            var row = self._lastPai.getComponent('Pai').x\r\n            var column = self._lastPai.getComponent('Pai').y\r\n            var currentY = Math.round((self._lastPai.y + self.paddingTop) / self.paiHeight)\r\n            var delta = currentY - row\r\n            var matchFound = false\r\n            cc.log('row: ' + row)\r\n            cc.log('currentY: ' + currentY)\r\n            cc.log('delta: '  + delta)\r\n            if (delta > 0) {\r\n                for (var i = self.moveStart; i <= self.moveEnd + delta; i++) {\r\n                    if (i < self.moveStart + delta && column != self.columns - 1 && column != 0) {\r\n                        var highY = column + 1\r\n                        while (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type === -1) {\r\n                            highY++\r\n                        }\r\n                        var lowY = column - 1\r\n                        while (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === -1) {\r\n                            lowY--\r\n                        }\r\n                        //cc.log('lowY: ' + lowY)\r\n                        //cc.log('highX: ' + highX + \", j: \" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\r\n                        //cc.log('lowX: ' + lowX + \", j: \" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\r\n                        if (lowY >= 0 && highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type === self._paiSprites[i][lowY].getComponent('Pai').type\r\n                            && self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\r\n                            matchFound = true\r\n                            break\r\n                        }\r\n                    }\r\n                    if (i >= self.moveStart + delta) {\r\n                        if (column != self.columns - 1) {\r\n                            var highY = column + 1\r\n                            while (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type === -1) {\r\n                                highY++\r\n                            }\r\n                            //cc.log('highY: ' + highY + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\r\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\r\n                            if (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type == self._paiSprites[i - delta][column].getComponent('Pai').type\r\n                                && self._paiSprites[i][highY].getComponent('Pai').type != -1) {\r\n                                    matchFound = true\r\n                                    break\r\n                            }\r\n                        }\r\n                        if (column != 0) {\r\n                            var lowY = column - 1\r\n                            while (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === -1) {\r\n                                lowY--\r\n                            }\r\n                            //cc.log('lowY: ' + lowY)\r\n                            //cc.log('lowX: ' + lowX + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\r\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\r\n                            if (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === self._paiSprites[i - delta][column].getComponent('Pai').type\r\n                                && self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\r\n                                matchFound = true\r\n                                break\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                cc.log(\"matchFound: \" + matchFound)\r\n                if (matchFound) {\r\n                    for (var i = self.moveEnd; i >= self.moveStart; i--) {\r\n                        //cc.log(\"x: \" + i + \", y: \" + (j + delta) + \", from: \" + self._paiSprites[row][j + delta].getComponent('Pai').type + \", to: \" + self._paiSprites[row][j].getComponent('Pai').type)\r\n                        var type = self._paiSprites[i][column].getComponent('Pai').type\r\n                        self._paiSprites[i + delta][column].getComponent('Pai').type = type\r\n                        self._paiSprites[i + delta][column].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[type]\r\n                        self._paiSprites[i + delta][column].index = self._paiSprites[i][column].index\r\n                        self._paiSprites[i + delta][column].width = self.paiWidth\r\n                        self._paiSprites[i + delta][column].height = self.paiHeight\r\n                        self._pais[self._paiSprites[i][column].index] = cc.v2(i + delta, column)\r\n                        if (i < self.moveStart + delta) {\r\n                            self._paiSprites[i][column].getComponent('Pai').type = -1\r\n                            self._paiSprites[i][column].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\r\n                        }\r\n                        //cc.log('set row: ' + row + ', j: ' + j + \" to \" + self._paiSprites[row][j].getComponent('Pai').x)\r\n                        self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\r\n                        self._paiSprites[i][column].zIndex = 0\r\n                        self._paiSprites[i][column].width = self.paiWidth\r\n                        self._paiSprites[i][column].height = self.paiHeight\r\n                    }\r\n                    self._lastPai.color = cc.Color.WHITE\r\n                    self._lastPai = self._paiSprites[currentY][column]\r\n                    self._lastPai.color = cc.Color.GRAY\r\n                    if (self.coward) {\r\n                        for (var i = 0; i < 4; i++) {\r\n                            var index = self._pais[self._lastPai.getComponent('Pai').type * 4 + i]\r\n                            if (index != null) {\r\n                                self._paiSprites[index.x][index.y].color = cc.Color.GRAY\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    for (var i = self.moveStart; i <= self.moveEnd; i++) {\r\n                        self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\r\n                        self._paiSprites[i][column].zIndex = 0\r\n                    }\r\n                }\r\n            } else if (delta < 0) {\r\n                for (var i = self.moveStart + delta; i <= self.moveEnd; i++) {\r\n                    if (i > self.moveEnd + delta && column != self.columns - 1 && column != 0) {\r\n                        var highY = column + 1\r\n                        while (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type === -1) {\r\n                            highY++\r\n                        }\r\n                        var lowY = column - 1\r\n                        while (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === -1) {\r\n                            lowY--\r\n                        }\r\n                        cc.log('i: ' + i + \", highY: \" + highY)\r\n                        if (highY < self.columns) {\r\n                            cc.log(self._paiSprites[i][highY].getComponent('Pai').type)\r\n                        }\r\n                        cc.log('i: ' + i + \", lowY: \" + lowY)\r\n                        if (lowY >= 0) {\r\n                            cc.log(self._paiSprites[i][lowY].getComponent('Pai').type)\r\n                        }\r\n                        //cc.log('highX: ' + highX + \", j: \" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\r\n                        //cc.log('lowX: ' + lowX + \", j: \" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\r\n                        if (highY < self.columns && lowY >= 0 && self._paiSprites[i][highY].getComponent('Pai').type === self._paiSprites[i][lowY].getComponent('Pai').type\r\n                            && self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\r\n                            matchFound = true\r\n                            break\r\n                        }\r\n                    }\r\n                    if (i <= self.moveEnd + delta) {\r\n                        if (column != self.columns - 1) {\r\n                            var highY = column + 1\r\n                            while (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type === -1) {\r\n                                highY++\r\n                            }\r\n                            cc.log('i: ' + i + \", highY: \" + highY + \", type: \" + highY < self.columns ? self._paiSprites[i][highY].getComponent('Pai').type : -1)\r\n                            cc.log('i: ' + i + \", column: \" + column + \", delta\" + delta + \", type: \" + self._paiSprites[i - delta][column].getComponent('Pai').type)\r\n                            if (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type == self._paiSprites[i - delta][column].getComponent('Pai').type\r\n                                && self._paiSprites[i][highY].getComponent('Pai').type != -1) {\r\n                                    matchFound = true\r\n                                    break\r\n                            }\r\n                        }\r\n                        if (column != 0) {\r\n                            var lowY = column - 1\r\n                            while (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === -1) {\r\n                                lowY--\r\n                            }\r\n                            cc.log('i: ' + i + \", lowY: \" + lowY + \", type: \" + lowY >= 0 ? self._paiSprites[i][lowY].getComponent('Pai').type : -1)\r\n                            cc.log('i: ' + i + \", column: \" + column + \", delta\" + delta + \", type: \" + self._paiSprites[i - delta][column].getComponent('Pai').type)\r\n                            if (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === self._paiSprites[i - delta][column].getComponent('Pai').type\r\n                                && self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\r\n                                matchFound = true\r\n                                break\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                cc.log(\"matchFound: \" + matchFound)\r\n                if (matchFound) {\r\n                    for (var i = self.moveStart; i <= self.moveEnd; i++) {\r\n                        //cc.log(\"x: \" + row + \", y: \" + (j + delta) + \", from: \" + self._paiSprites[row][j + delta].getComponent('Pai').type + \", to: \" + self._paiSprites[row][j].getComponent('Pai').type)\r\n                        var type = self._paiSprites[i][column].getComponent('Pai').type\r\n                        self._paiSprites[i + delta][column].getComponent('Pai').type = type\r\n                        self._paiSprites[i + delta][column].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[type]\r\n                        self._paiSprites[i + delta][column].index = self._paiSprites[i][column].index\r\n                        self._paiSprites[i + delta][column].width = self.paiWidth\r\n                        self._paiSprites[i + delta][column].height = self.paiHeight\r\n                        self._pais[self._paiSprites[i][column].index] = cc.v2(i + delta, column)\r\n                        if (i > self.moveEnd + delta) {\r\n                            self._paiSprites[i][column].getComponent('Pai').type = -1\r\n                            self._paiSprites[i][column].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\r\n                        }\r\n                        //cc.log('set row: ' + row + ', j: ' + j + \" to \" + self._paiSprites[row][j].getComponent('Pai').x)\r\n                        self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\r\n                        self._paiSprites[i][column].zIndex = 0\r\n                        self._paiSprites[i][column].width = self.paiWidth\r\n                        self._paiSprites[i][column].height = self.paiHeight\r\n                    }\r\n                    self._lastPai.color = cc.Color.WHITE\r\n                    self._lastPai = self._paiSprites[currentY][column]\r\n                    self._lastPai.color = cc.Color.GRAY\r\n                    if (self.coward) {\r\n                        for (var i = 0; i < 4; i++) {\r\n                            var index = self._pais[self._lastPai.getComponent('Pai').type * 4 + i]\r\n                            if (index != null) {\r\n                                self._paiSprites[index.x][index.y].color = cc.Color.GRAY\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    for (var i = self.moveStart; i <= self.moveEnd; i++) {\r\n                        self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\r\n                        self._paiSprites[i][column].zIndex = 0\r\n                    }\r\n                }\r\n            } else {\r\n                for (var i = self.moveStart; i <= self.moveEnd; i++) {\r\n                    self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\r\n                    self._paiSprites[i][column].zIndex = 0\r\n                }\r\n            }\r\n        }\r\n        self.moveDirection = -1\r\n\r\n        this.diedGame();\r\n    },\r\n    switchPai(x1, y1, x2, y2) {\r\n        var tempType = this._paiSprites[x1][y1].getComponent('Pai').type;\r\n        var tempX = this._paiSprites[x1][y1].getComponent('Pai').x;\r\n        var tempY = this._paiSprites[x1][y1].getComponent('Pai').y;\r\n\r\n        var targetType = this._paiSprites[x2][y2].getComponent('Pai').type;\r\n        var targetX = this._paiSprites[x2][y2].getComponent('Pai').x;\r\n        var targetY = this._paiSprites[x2][y2].getComponent('Pai').y;\r\n\r\n        if (targetType < 0 || tempType < 0) {\r\n            return;\r\n        }\r\n\r\n        this._paiSprites[x1][y1].getComponent(cc.Sprite).spriteFrame = this.spriteFrames[targetType]\r\n        this._paiSprites[x1][y1].getComponent('Pai').type = targetType;\r\n        this._paiSprites[x1][y1].width = this.paiWidth;\r\n        this._paiSprites[x1][y1].height = this.paiHeight;\r\n\r\n\r\n        this._paiSprites[x2][y2].getComponent(cc.Sprite).spriteFrame = this.spriteFrames[tempType]\r\n        this._paiSprites[x2][y2].getComponent('Pai').type = tempType;\r\n        this._paiSprites[x2][y2].width = this.paiWidth;\r\n        this._paiSprites[x2][y2].height = this.paiHeight;\r\n\r\n    },\r\n    reshuffle() {\r\n        var indexes = [];\r\n        for (var i = 0; i < this.rows; i++) {\r\n            for (var j = 0; j < this.columns; j++) {\r\n                var pai = this._paiSprites[i][j].getComponent('Pai');\r\n                if (pai.type >= 0) {\r\n                    indexes.push({x:i,y:j});\r\n                }\r\n            }\r\n        }\r\n\r\n        var array = new Array(indexes.length);\r\n        var m = array.length, t, index;\r\n        for (var i = 0; i < m; i++) {\r\n            array[i] = i\r\n        }\r\n\r\n        while (m) {\r\n          index = Math.floor(Math.random() * m--);\r\n\r\n          // And swap it with the current element.\r\n          t = array[m];\r\n          array[m] = array[index];\r\n          array[index] = t;\r\n        }\r\n\r\n        for (var i = 0; i < array.length ; i++) {\r\n            var x1 = indexes[i].x;\r\n            var y1 = indexes[i].y;\r\n            var x2 = indexes[array[i]].x;\r\n            var y2 = indexes[array[i]].y;\r\n            this.switchPai(x1,y1,x2,y2);\r\n        }\r\n        \r\n    },\r\n    shuffle() {\r\n        var array = new Array(this.rows * this.columns)\r\n        var m = array.length, t, index;\r\n        for (var i = 0; i < this.rows * this.columns; i++) {\r\n            array[i] = i\r\n        }\r\n\r\n        // While there remain elements to shuffle…\r\n        while (m) {\r\n          // Pick a remaining element…\r\n          index = Math.floor(Math.random() * m--);\r\n\r\n          // And swap it with the current element.\r\n          t = array[m];\r\n          array[m] = array[index];\r\n          array[index] = t;\r\n        }\r\n\r\n        for (var i = 0; i < this.rows; i++) {\r\n            for (var j = 0; j < this.columns; j++) {\r\n                var index = i * this.columns + j\r\n                var type = Math.trunc(array[index] / 4)\r\n                this._paiSprites[i][j].getComponent(cc.Sprite).spriteFrame = this.spriteFrames[type]\r\n                this._paiSprites[i][j].getComponent('Pai').type = type\r\n                this._paiSprites[i][j].getComponent('Pai').x = i\r\n                this._paiSprites[i][j].getComponent('Pai').y = j\r\n                this._paiSprites[i][j].width = this.paiWidth\r\n                this._paiSprites[i][j].height = this.paiHeight\r\n                this._paiSprites[i][j].index = array[index]\r\n                cc.log(array[index] + \", \" + i + \", \" + j)\r\n                this._pais[array[index]] = cc.v2(i, j)\r\n            }\r\n        }\r\n    },\r\n\r\n    winSplash () {\r\n        var init = cc.moveTo(0, cc.v2(Math.random() * this.paiWidth * this.columns - this.paddingLeft, this.paiHeight * this.rows / 2))\r\n        var start = cc.moveBy(Math.random() / 2, cc.v2(0, -this.paiHeight)).easing(cc.easeCubicActionOut());\r\n        var scaleUp = cc.scaleTo(Math.random() / 2, 0.8, 0.8)\r\n        var move = cc.moveBy(Math.random() * 3, cc.v2(0, -this.paiHeight * (this.rows - 2))).easing(cc.easeCubicActionOut());\r\n        var scaleDown = cc.scaleTo(Math.random() / 2, 0.5, 0.5)\r\n        var end = cc.moveBy(Math.random() / 2, cc.v2(0, -this.paiHeight))\r\n        return cc.repeatForever(cc.sequence(init, start, scaleUp, move, scaleDown, end))\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}