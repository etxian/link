{"version":3,"sources":["../../../../assets/scripts/assets/scripts/game.js"],"names":["cc","Class","extends","Component","properties","paiPrefab","default","type","Prefab","spriteFrames","SpriteFrame","tutorial","Node","startButton","Button","hintButton","scoreLabel","Label","_paiSprites","_pais","rows","columns","paiWidth","paiHeight","paddingLeft","paddingTop","solutionx1","solutiony1","solutionx2","solutiony2","suggestionTimer","_lastPai","lastX","lastY","moveDirection","moveStart","moveEnd","moveMin","moveMax","originalX","originalY","mouseDown","count","coward","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","active","event","keyCode","macro","KEY","n","getComponent","i","index","x","y","color","Color","WHITE","onDestroy","pais","j","sys","localStorage","setItem","log","onGameHints","clearTimeout","setTimeout","highLightSolution","onGameStart","Array","self","newNode","instantiate","Sprite","spriteFrame","Math","trunc","node","addChild","setPosition","v2","TOUCH_END","onTouchEnd","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","paisStorage","getItem","split","shuffle","enabled","string","width","height","stopHighLightSolution","diedGame","livePai","map","pai","t","o","push","staticLiveGame","delta","c","k","temp","mode","centerx","centery","offset","key","length","connected","adjustPosition","x1","y1","x2","y2","small","big","adjusted1","adjusted2","toString","row","column","zIndex","currentPai","floor","getLocationY","getLocationX","currentX","currentY","match","lowX","min","lowY","highX","max","highY","random","runAction","winSplash","GRAY","getDelta","location","getLocation","abs","round","matchFound","switchPai","tempType","tempX","tempY","targetType","targetX","targetY","reshuffle","indexes","array","m","init","moveTo","start","moveBy","easing","easeCubicActionOut","scaleUp","scaleTo","move","scaleDown","end","repeatForever","sequence"],"mappings":"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","file":"game.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        paiPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n\n        spriteFrames: {\n            default: [],\n            type: [cc.SpriteFrame]\n        },\n\n        tutorial: {\n            default: null,\n            type: cc.Node\n        },\n\n        startButton: {\n            default: null,\n            type: cc.Button\n        },\n        hintButton: {\n            default: null,\n            type: cc.Button\n        },\n        scoreLabel: {\n            default: null,\n            type: cc.Label\n        }\n        ,\n        _paiSprites: {\n            default: [],\n            type: [cc.Node]\n        },\n\n        _pais: null,\n\n        rows: 8,\n        columns: 17,\n\n        paiWidth: 60,\n        paiHeight: 90,\n\n        paddingLeft: 640,\n        paddingTop: 360, //360,\n        solutionx1: -1,\n        solutiony1: -1,\n        solutionx2: -1,\n        solutiony2: -1,\n        suggestionTimer: null,\n\n        _lastPai: null,\n        lastX: 0,\n        lastY: 0,\n\n        moveDirection: -1,\n        moveStart: 0,\n        moveEnd: 0,\n        moveMin: 0,\n        moveMax: 0,\n        originalX: 0,\n        originalY: 0,\n\n        mouseDown: false,\n        count: 0,\n\n        coward: false\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this)\n        \n        this.hintButton.active = false;\n    },\n\n    onKeyDown (event) {\n        switch(event.keyCode) {\n            case cc.macro.KEY.n:\n                if (this.coward && this._lastPai != null && this._lastPai.getComponent('Pai').type != -1) {\n                    for (var i = 0; i < 4; i++) {\n                        var index = this._pais[this._lastPai.getComponent('Pai').type  * 4 + i]\n                        if (index != null) {\n                            this._paiSprites[index.x][index.y].color = cc.Color.WHITE\n                        }\n                    }\n                }\n                this.coward = !this.coward\n                break\n        }\n    },\n\n    onDestroy () {\n        var pais = \"\"\n        for (var i = 0; i < this.rows; i++) {\n            for (var j = 0; j < this.columns; j++) {\n                pais += this._paiSprites[i][j].getComponent('Pai').type + \" \"\n            }\n        }\n        cc.sys.localStorage.setItem('pais', pais)\n        cc.log('save state')\n    },\n    onGameHints() {\n        clearTimeout(this.suggestionTimer);\n        this.suggestionTimer = setTimeout(\n            () => { \n                this.highLightSolution(); \n            }\n            , 500);\n    },\n    onGameStart () {\n        this._pais = new Array(this.rows * this.columns)\n        this._paiSprites = new Array(this.rows)\n        for (var i = 0; i < this.rows; i++) {\n            this._paiSprites[i] = new Array(this.columns)\n            for (var j = 0; j < this.columns; j++) {\n                this._paiSprites[i][j] = null\n            }\n        }\n\n        var self = this\n        for (var i = 0; i < this.rows; i++) {\n            for (var j = 0; j < this.columns; j++) {\n                var newNode = cc.instantiate(this.paiPrefab)\n                newNode.getComponent(cc.Sprite).spriteFrame = this.spriteFrames[Math.trunc((i * this.rows + j) / 4)]\n                this._paiSprites[i][j] = newNode\n                this.node.addChild(newNode)\n                newNode.setPosition(cc.v2(this.paiWidth * j - this.paddingLeft, this.paiHeight * i - this.paddingTop))\n            }\n        }\n        this.node.on(cc.Node.EventType.TOUCH_END, function(event) {\n            this.onTouchEnd(event, self)\n        }, this)\n        this.node.on(cc.Node.EventType.TOUCH_START, function(event) {\n            this.onTouchStart(event, self)\n        }, this)\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, function(event) {\n            this.onTouchMove(event, self)\n        }, this)\n\n        var paisStorage = cc.sys.localStorage.getItem('pais')\n        if (paisStorage != null) {\n            var pais = paisStorage.split(' ')\n            for (var i = 0; i < this.rows; i++) {\n                for (var j = 0; j < this.columns; j++) {\n                    this._paiSprites[i][j].getComponent(cc.Sprite).spriteFrame = this.spriteFrames[pais[i * columns + j] == -1 ? 34 : pais[i * columns + j]]\n                    this._paiSprites[i][j].getComponent('Pai').type = pais[i * columns + j]\n                }\n            }\n        } else {\n            this.shuffle()\n        }\n        this.tutorial.active = false\n        this.startButton.active = false\n        this.startButton.enabled = false\n        //this.hintButton.enabled = true;\n        this.hintButton.active = false;\n        this.hintButton.enabled = false;\n        this.hintButton.node.active = false;\n        this.scoreLabel.string = \"0\";\n    },\n    highLightSolution() {\n        if (this.solutionx1 >= 0 && this.solutionx2 >= 0 && this.solutiony1 >= 0 && this.solutiony2 >= 0) {\n            this._paiSprites[this.solutionx1][this.solutiony1].width = this.paiWidth + 15;\n            this._paiSprites[this.solutionx1][this.solutiony1].height = this.paiHeight + 15;\n            this._paiSprites[this.solutionx2][this.solutiony2].width = this.paiWidth + 15;\n            this._paiSprites[this.solutionx2][this.solutiony2].height = this.paiHeight + 15;\n        }\n        setTimeout(() => {this.stopHighLightSolution()}, 300);\n    },\n    stopHighLightSolution() {\n        if (this.solutionx1 >= 0 && this.solutionx2 >= 0 && this.solutiony1 >= 0 && this.solutiony2 >= 0) {\n            this._paiSprites[this.solutionx1][this.solutiony1].width = this.paiWidth;\n            this._paiSprites[this.solutionx1][this.solutiony1].height = this.paiHeight;\n            this._paiSprites[this.solutionx2][this.solutiony2].width = this.paiWidth;\n            this._paiSprites[this.solutionx2][this.solutiony2].height = this.paiHeight;\n        }\n    },\n\n    diedGame() {\n        var livePai = {}\n        var map = new Array(this.rows);\n\n        for (var i = 0; i < this.rows; i++) {\n            map[i] = [];\n            for (var j = 0; j < this.columns; j++) {\n                var pai = this._paiSprites[i][j].getComponent('Pai');\n                var t = pai.type;\n                var o = {type: t, x: i, y: j};\n                map[i].push(o);\n                if (t == -1) {\n                    continue;\n                }\n\n                if (t in livePai) {\n                    livePai[t].push(o);\n                } else {\n                    livePai[t] = [o];\n                }\n            }\n        }\n\n        if (this.staticLiveGame(map, livePai, 0, 0, 0, 0)) {\n            return false;\n        }\n\n        for (var i = 0; i < this.rows; i++) {\n            for (var j = 0; j < this.columns; j++) {\n                if (map[i][j].type != -1) {\n                    continue;\n                }\n\n                // ======================\n                // try to move left pais to current location\n                var x = i - 1;\n                while(x>-1 && map[x][j].type < 0) {\n                    x--;\n                }\n\n                // if x >= 0, that mean there is pai on left can be moved\n                if (x >= 0) {\n                    var delta = i - x;\n                    var c = 0;\n                    while((x-c)>=0 && map[x-c][j].type >= 0) {\n                        c++;\n                    }\n\n                    // move pai\n                    for(var k=0;k<c;k++) {\n                        var temp = map[i-k][j];\n                        map[i-k][j] = map[x-k][j];\n                        map[i-k][j].x = i-k;\n                        map[x-k][j] = temp;\n                        map[x-k][j].x = x-k;\n                    }\n\n                    if(this.staticLiveGame(map, livePai, 1, i, j, delta, c)) {\n                        return false;\n                    }\n\n                    // resume pai\n                    for(var k = c-1; k >= 0; k--) {\n                        var temp = map[i-k][j];\n                        map[i-k][j] = map[x-k][j];\n                        map[i-k][j].x = i-k;\n                        map[x-k][j] = temp;\n                        map[x-k][j].x = x-k;\n                    }\n                    \n                }\n                // ====================\n                // try to move right pais to current location\n                x = i + 1;\n                while(x < this.rows && map[x][j].type < 0) {\n                    x++;\n                }\n\n                // if x < columns, that mean there is pai on right can be moved\n                if (x < this.rows) {\n                    var delta = x - i;\n                    var c = 0;\n                    while((x+c) < this.rows && map[x+c][j].type >= 0) {\n                        c++;\n                    }\n\n                    // move pai\n                    for(var k=0;k<c;k++) {\n                        var temp = map[i+k][j];\n                        map[i+k][j] = map[x+k][j];\n                        map[i+k][j].x = i+k;\n                        map[x+k][j] = temp;\n                        map[x+k][j].x = x+k;\n                    }\n\n                    if(this.staticLiveGame(map, livePai, 2, i, j, delta, c)) {\n                        return false;\n                    }\n\n                    // resume pai\n                    for(var k = c-1; k >= 0; k--) {\n                        var temp = map[i+k][j];\n                        map[i+k][j] = map[x+k][j];\n                        map[i+k][j].x = i+k;\n                        map[x+k][j] = temp;\n                        map[x+k][j].x = x+k;\n                    }\n                    \n                }\n\n                // ====================================\n                x = j - 1;\n                while(x > -1 && map[i][x].type < 0) {\n                    x--;\n                }\n\n                // if x >= 0, that mean there is pai  can be moved\n                if (x >= 0) {\n                    var delta = j - x;\n                    var c = 0;\n                    while((x-c)>=0 && map[i][x-c].type >= 0) {\n                        c++;\n                    }\n\n                    // move pai\n                    for(var k=0;k<c;k++) {\n                        var temp = map[i][j-k];\n                        map[i][j-k] = map[i][x-k];\n                        map[i][j-k].y = j-k;\n                        map[i][x-k] = temp;\n                        map[i][x-k].y = x-k;\n                    }\n\n                    if(this.staticLiveGame(map, livePai, 3, i, j, delta, c)) {\n                        return false;\n                    }\n\n                    // resume pai\n                    for(var k = c-1; k >= 0; k--) {\n                        var temp = map[i][j-k];\n                        map[i][j-k] = map[i][x-k];\n                        map[i][j-k].y = j-k;\n                        map[i][x-k] = temp;\n                        map[i][x-k].y = x-k;\n                    }\n                    \n                }\n                // ====================\n                // try to move right pais to current location\n                x = j + 1;\n                while(x < this.columns && map[i][x].type < 0) {\n                    x++;\n                }\n\n                // if x < columns, that mean there is pai on right can be moved\n                if (x < this.columns) {\n                    var delta = x - j;\n                    var c = 0;\n                    while((x+c) < this.columns && map[i][x+c].type >= 0) {\n                        c++;\n                    }\n\n                    // move pai\n                    for(var k=0;k<c;k++) {\n                        var temp = map[i][j+k];\n                        map[i][j+k] = map[i][x+k];\n                        map[i][j+k].y = j+k;\n                        map[i][x+k] = temp;\n                        map[i][x+k].y = x+k;\n                    }\n\n                    if(this.staticLiveGame(map, livePai, 4, i, j, delta, c)) {\n                        return false;\n                    }\n\n                    // resume pai\n                    for(var k = c-1; k >= 0; k--) {\n                        var temp = map[i][j+k];\n                        map[i][j+k] = map[i][x+k];\n                        map[i][j+k].y = j+k;\n                        map[i][x+k] = temp;\n                        map[i][x+k].y = x+k;\n                    }\n                    \n                }\n            }\n        }\n\n        return true;\n    },\n    // check map, if there steps available\n    staticLiveGame(map, livePai, mode, centerx, centery, offset, count) {\n        for(var key in livePai) {\n            var pais = livePai[key];\n            for(var i=0;i<pais.length-1;i++) {\n                for(var j=i+1;j<pais.length;j++) {\n                    if (this.connected(map, pais[i].x, pais[i].y, pais[j].x, pais[j].y, mode, centerx, centery, offset, count)) {\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    },\n    adjustPosition(x, y, mode, centerx, centery, offset, count) {\n        if (mode == 1) {\n            if (y == centery) {\n                if (x <= centerx && x >= (centerx-count)) {\n                    return [x - offset, y];\n                }\n            }\n        }\n\n        if (mode == 2) {\n            if (y == centery) {\n                if (x <= (centerx + count) && x >= centerx) {\n                    return [x + offset, y];\n                }\n            }\n        }\n\n        if (mode == 3) {\n            if (x == centerx) {\n                if (y < centery && y >= centery - count) {\n                    return [x, y - offset];\n                }\n            }\n        }\n\n        if (mode == 4) {\n            if (x == centerx) {\n                if (y <= (centery + count) && y >= centery) {\n                    return [x, y + offset];\n                }\n            }\n        }\n\n        return [x, y];\n    },\n    connected(map, x1, y1, x2, y2, mode, centerx, centery, offset, count) {\n        if (x1 == x2) {\n            var small = y1;\n            var big = y2;\n            if (y1 > y2) {\n                small = y2;\n                big = y1;\n            }\n\n            for (var i = small+1; i < big; i++ )\n            {\n                if (map[x1][i].type != -1) {\n                    return false;\n                }\n            }\n            var adjusted1 = this.adjustPosition(x1, y1, mode, centerx, centery, offset, count);\n            var adjusted2 = this.adjustPosition(x2, y2, mode, centerx, centery, offset, count);\n            this.solutionx1 = adjusted1[0];\n            this.solutiony1 = adjusted1[1];\n            this.solutionx2 = adjusted2[0];\n            this.solutiony2 = adjusted2[1];\n            cc.log(\"connected: \" + adjusted1[0].toString() + \", \" + adjusted1[1].toString() + \"; \" + adjusted2[0].toString() + \", \" + adjusted2[1].toString())\n            return true;\n        }\n\n        if (y1 == y2) {\n            var small = x1;\n            var big = x2;\n            if (x1 > x2) {\n                small = x2;\n                big = x1;\n            }\n\n            for (var i = small+1; i < big; i++ )\n            {\n                if (map[i][y1].type != -1) {\n                    return false;\n                }\n            }\n            var adjusted1 = this.adjustPosition(x1, y1, mode, centerx, centery, offset, count);\n            var adjusted2 = this.adjustPosition(x2, y2, mode, centerx, centery, offset, count);\n            this.solutionx1 = adjusted1[0];\n            this.solutiony1 = adjusted1[1];\n            this.solutionx2 = adjusted2[0];\n            this.solutiony2 = adjusted2[1];\n            cc.log(\"connected: \" + adjusted1[0].toString() + \", \" + adjusted1[1].toString() + \"; \" + adjusted2[0].toString() + \", \" + adjusted2[1].toString())\n            return true;\n        }\n        return false;\n    },\n    onTouchStart (event, self) {\n        if (self.mouseDown === true && self._lastPai != null) {\n            var row = self._lastPai.getComponent('Pai').x\n            var column = self._lastPai.getComponent('Pai').y\n            if (self.moveDirection === 0) {\n                for (var j = self.moveStart; j <= self.moveEnd; j++) {\n                    self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\n                    self._paiSprites[row][j].zIndex = 0\n                }\n            } else if (self.moveDirection === 1) {\n                for (var i = self.moveStart; i <= self.moveEnd; i++) {\n                    self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\n                    self._paiSprites[i][column].zIndex = 0\n                }\n            }\n        }\n        self.mouseDown = true\n        var currentPai = self._paiSprites[Math.floor(event.getLocationY() / this.paiHeight)][Math.floor(event.getLocationX() / this.paiWidth)]\n        if (self._lastPai != null) {\n            self._lastPai.color = cc.Color.WHITE\n            if (self.coward && self._lastPai.getComponent('Pai').type != -1) {\n                for (var i = 0; i < 4; i++) {\n                    var index = self._pais[self._lastPai.getComponent('Pai').type  * 4 + i]\n                    if (index != null) {\n                        self._paiSprites[index.x][index.y].color = cc.Color.WHITE\n                    }\n                }\n            }\n            if (currentPai.getComponent('Pai').type === self._lastPai.getComponent('Pai').type && self._lastPai.getComponent('Pai').type != -1 && currentPai != self._lastPai) {\n                var currentX = currentPai.getComponent('Pai').x\n                var currentY = currentPai.getComponent('Pai').y\n                var lastX = self._lastPai.getComponent('Pai').x\n                var lastY = self._lastPai.getComponent('Pai').y\n\n                cc.log(\"current: \" + currentX + \",\" + currentY)\n                cc.log(\"last: \" + lastX + \",\" + lastY)\n                var match = true\n                var lowX = Math.min(currentX, lastX)\n                var lowY = Math.min(currentY, lastY)\n                var highX = Math.max(currentX, lastX)\n                var highY = Math.max(currentY, lastY)\n\n                if ((currentX < lastX && currentY < lastY) || (currentX >= lastX && currentY >= lastY)) {\n                    cc.log(\"a\")\n                    for (var i = lowX + 1; i <= highX; i++) {\n                        cc.log(\"a1: \" + i + \",\" + lowY + \":\" + self._paiSprites[i][lowY].getComponent('Pai').type)\n                        if (i != highX && self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\n                            match = false\n                            break\n                        }\n                    }\n\n                    if (match) {\n                        for (var j = lowY; j < highY; j++) {\n                            cc.log(\"a2: \" + highX + \",\" + j + \":\" + self._paiSprites[highX][j].getComponent('Pai').type)\n                            if (self._paiSprites[highX][j].getComponent('Pai').type != -1) {\n                                match = false\n                                break\n                            }\n                        }\n                    }\n\n                    if (!match) {\n                        match = true\n                        for (var j = lowY + 1; j <= highY; j++) {\n                            cc.log(\"a3: \" + lowX + \",\" + j + \":\" + self._paiSprites[lowX][j].getComponent('Pai').type)\n                            if (j != highY && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\n                                match = false\n                                break\n                            }\n                        }\n\n                        if (match) {\n                            for (var i = lowX; i < highX; i++) {\n                                cc.log(\"a4: \" + i + \",\" + highY + \":\" + self._paiSprites[i][highY].getComponent('Pai').type)\n                                if (self._paiSprites[i][highY].getComponent('Pai').type != -1) {\n                                    match = false\n                                    break\n                                }\n                            }\n                        }\n                    }\n                } else if ((currentX >= lastX && currentY < lastY) || (currentX < lastX && currentY >= lastY)) {\n                    cc.log(\"b\")\n                    for (var i = lowX + 1; i <= highX; i++) {\n                        cc.log(\"b1: \" + i + \",\" + highY + \":\" + self._paiSprites[i][highY].getComponent('Pai').type)\n                        if (i != highX && self._paiSprites[i][highY].getComponent('Pai').type != -1) {\n                            match = false\n                            break\n                        }\n                    }\n\n                    if (match) {\n                        for (var j = highY; j > lowY; j--) {\n                            cc.log(\"b2: \" + highX + \",\" + j + \":\" + self._paiSprites[highX][j].getComponent('Pai').type)\n                            if (self._paiSprites[highX][j].getComponent('Pai').type != -1) {\n                                match = false\n                                break\n                            }\n                        }\n                    }\n\n                    if (!match) {\n                        match = true\n                        for (var j = highY - 1; j >= lowY; j--) {\n                            cc.log(\"b3: \" + lowX + \",\" + j + \":\" + self._paiSprites[lowX][j].getComponent('Pai').type)\n                            if (j != lowY && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\n                                match = false\n                                break\n                            }\n                        }\n\n                        if (match) {\n                            for (var i = lowX; i < highX; i++) {\n                                cc.log(\"b4: \" + i + \",\" + lowY + \":\" + self._paiSprites[i][lowY].getComponent('Pai').type)\n                                if (self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\n                                    match = false\n                                    break\n                                }\n                            }\n                        }\n                    }\n                }\n                if (match) {\n                    currentPai.getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\n                    currentPai.width = this.paiWidth\n                    currentPai.height = this.paiHeight\n                    self._lastPai.getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\n                    self._lastPai.width = this.paiWidth\n                    self._lastPai.height = this.paiHeight\n                    currentPai.getComponent('Pai').type = -1\n                    self._lastPai.getComponent('Pai').type = -1\n                    self._pais[self._lastPai.index] = null\n                    self._pais[currentPai.index] = null\n                    currentPai.color = cc.Color.WHITE\n                    \n                    self.count += 2\n                    if (self.count >= self.rows * self.columns) {\n                        for (var i = 0; i < this.rows; i++) {\n                            for (var j = 0; j < this.columns; j++) {\n                                self._paiSprites[i][j].getComponent(cc.Sprite).spriteFrame = this.spriteFrames[Math.trunc(Math.random() * 35)]\n                                self._paiSprites[i][j].runAction(self.winSplash())\n                            }\n                        }\n                    } else {\n                        cc.log(\"Check died game:\");\n                        // while(this.diedGame()) {\n                        //     this.reshuffle();\n                        // }\n                    }\n                }\n            }\n        }\n        currentPai.color = cc.Color.GRAY\n        self._lastPai = currentPai\n        if (self.coward && currentPai.getComponent('Pai').type != -1) {\n            for (var i = 0; i < 4; i++) {\n                var index = self._pais[currentPai.getComponent('Pai').type * 4 + i]\n                if (index != null && self._paiSprites[index.x][index.y].getComponent('Pai').type != -1) {\n                    self._paiSprites[index.x][index.y].color = cc.Color.GRAY\n                }\n            }\n        }\n        self.originalX = currentPai.getComponent('Pai').x\n        self.originalY = currentPai.getComponent('Pai').y\n    },\n\n    onTouchMove (event, self) {\n        var delta = event.getDelta()\n        var location = event.getLocation()\n        if (self._lastPai != null && self._lastPai.getComponent('Pai').type != -1) {\n            var x = self._lastPai.getComponent('Pai').x\n            var y = self._lastPai.getComponent('Pai').y\n            if (self.moveDirection === -1) {\n                if (Math.abs(delta.x) > Math.abs(delta.y)) {\n                    self.moveDirection = 0\n                    if (y === 0) {\n                        self.moveStart = 0\n                        self.moveMin = 0\n                    } else {\n                        var i = y - 1\n                        while (i >= 0 && self._paiSprites[x][i].getComponent('Pai').type != -1) {\n                            i--\n                        }\n                        self.moveStart = i + 1\n                        while (i >= 0 && self._paiSprites[x][i].getComponent('Pai').type === -1) {\n                            i--\n                        }\n                        self.moveMin = i + 1\n                    }\n                    if (y === self.columns - 1) {\n                        self.moveEnd = self.columns - 1\n                        self.moveMax = self.columns - 1\n                    } else {\n                        var i = y + 1\n                        while (i < self.columns && self._paiSprites[x][i].getComponent('Pai').type != -1) {\n                            i++\n                        }\n                        self.moveEnd = i - 1\n                        while (i < self.columns && self._paiSprites[x][i].getComponent('Pai').type === -1) {\n                            i++\n                        }\n                        self.moveMax = i - 1\n                    }\n                    for (var j = self.moveStart; j <= self.moveEnd; j++) {\n                        self._paiSprites[x][j].zIndex = 1000\n                    }\n                } else {\n                    self.moveDirection = 1\n                    if (x === 0) {\n                        self.moveStart = 0\n                        self.moveMin = 0\n                    } else {\n                        var i = x - 1\n                        while (i >= 0 && self._paiSprites[i][y].getComponent('Pai').type != -1) {\n                            i--\n                        }\n                        self.moveStart = i + 1\n                        while (i >= 0 && self._paiSprites[i][y].getComponent('Pai').type === -1) {\n                            i--\n                        }\n                        self.moveMin = i + 1\n                    }\n                    if (x === self.rows - 1) {\n                        self.moveEnd = self.rows - 1\n                    } else {\n                        var i = x + 1\n                        while (i < self.rows && self._paiSprites[i][y].getComponent('Pai').type != -1) {\n                            i++\n                        }\n                        self.moveEnd = i - 1\n                        while (i < self.rows && self._paiSprites[i][y].getComponent('Pai').type === -1) {\n                            i++\n                        }\n                        self.moveMax = i - 1\n                    }\n                    for (var i = self.moveStart; i <= self.moveEnd; i++) {\n                        self._paiSprites[i][y].zIndex = 1000\n                    }\n                }\n            }\n\n            if (self.moveDirection === 0) {\n                var row = self._lastPai.getComponent('Pai').x\n                if ((delta.x > 0 && self._paiSprites[row][self.moveEnd].x + delta.x <= self.moveMax * self.paiWidth - self.paddingLeft)\n                    || (delta.x < 0 && self._paiSprites[row][self.moveStart].x + delta.x >= self.moveMin * self.paiWidth - self.paddingLeft)) {\n                    for (var j = self.moveStart; j <= self.moveEnd; j++) {\n                        self._paiSprites[row][j].x += delta.x\n                        self._paiSprites[row][j].zIndex = 1000\n                    }\n                }\n            } else {\n                var column = self._lastPai.getComponent('Pai').y\n                if ((delta.y > 0 && self._paiSprites[self.moveEnd][column].y + delta.y <= self.moveMax * self.paiHeight - self.paddingTop)\n                    || (delta.y < 0 && self._paiSprites[self.moveStart][column].y + delta.y >= self.moveMin * self.paiHeight - self.paddingTop)) {\n                    for (var i = self.moveStart; i <= self.moveEnd; i++) {\n                        self._paiSprites[i][column].y += delta.y\n                        self._paiSprites[i][column].zIndex = 1000\n                    }\n                }\n            }\n        }\n    },\n\n    onTouchEnd (event, self) {\n        cc.log('touchEnd: ')\n        self.mouseDown = false\n        if (self.moveDirection === 0) {\n            var row = self._lastPai.getComponent('Pai').x\n            var column = self._lastPai.getComponent('Pai').y\n            var currentX = Math.round((self._lastPai.x + this.paddingLeft) / self.paiWidth)\n            var delta = currentX - column\n            var matchFound = false\n            // cc.log('column: ' + column)\n            // cc.log('currentX: ' + currentX)\n            // cc.log('delta: '  + delta)\n            if (delta > 0) {\n                for (var j = self.moveStart; j <= self.moveEnd + delta; j++) {\n                    if (j < self.moveStart + delta && row != self.rows - 1 && row != 0) {\n                        var highX = row + 1\n                        while (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type === -1) {\n                            highX++\n                        }\n                        var lowX = row - 1\n                        while (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === -1) {\n                            lowX--\n                        }\n                        //cc.log('lowX: ' + lowX)\n                        //cc.log('highX: ' + highX + \", j: \" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\n                        //cc.log('lowX: ' + lowX + \", j: \" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\n                        if (lowX >= 0 && highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type === self._paiSprites[lowX][j].getComponent('Pai').type\n                            && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\n                            matchFound = true\n                            break\n                        }\n                    }\n                    if (j >= self.moveStart + delta) {\n                        if (row != self.rows - 1) {\n                            var highX = row + 1\n                            while (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type === -1) {\n                                highX++\n                            }\n                            //cc.log('highX: ' + highX + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\n                            if (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type == self._paiSprites[row][j - delta].getComponent('Pai').type\n                                && self._paiSprites[highX][j].getComponent('Pai').type != -1) {\n                                    matchFound = true\n                                    break\n                            }\n                        }\n                        if (row != 0) {\n                            var lowX = row - 1\n                            while (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === -1) {\n                                lowX--\n                            }\n                            //cc.log('lowX: ' + lowX + \", j: \" + \"\" + j)\n                            //cc.log('lowX: ' + lowX + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\n                            if (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === self._paiSprites[row][j - delta].getComponent('Pai').type\n                                && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\n                                matchFound = true\n                                break\n                            }\n                        }\n                    }\n                }\n                cc.log(\"matchFound: \" + matchFound)\n                if (matchFound) {\n                    for (var j = self.moveEnd; j >= self.moveStart; j--) {\n                        //cc.log(\"x: \" + row + \", y: \" + (j + delta) + \", from: \" + self._paiSprites[row][j + delta].getComponent('Pai').type + \", to: \" + self._paiSprites[row][j].getComponent('Pai').type)\n                        var type = self._paiSprites[row][j].getComponent('Pai').type\n                        self._paiSprites[row][j + delta].getComponent('Pai').type = type\n                        self._paiSprites[row][j + delta].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[type]\n                        self._paiSprites[row][j + delta].index = self._paiSprites[row][j].index\n                        self._paiSprites[row][j + delta].width = self.paiWidth\n                        self._paiSprites[row][j + delta].height = self.paiHeight\n                        self._pais[self._paiSprites[row][j].index] = cc.v2(row, j + delta)\n                        if (j < self.moveStart + delta) {\n                            self._paiSprites[row][j].getComponent('Pai').type = -1\n                            self._paiSprites[row][j].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\n                        }\n                        //cc.log('set row: ' + row + ', j: ' + j + \" to \" + self._paiSprites[row][j].getComponent('Pai').x)\n                        self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\n                        self._paiSprites[row][j].zIndex = 0\n                        self._paiSprites[row][j].width = self.paiWidth\n                        self._paiSprites[row][j].height = self.paiHeight\n                    }\n                    self._lastPai.color = cc.Color.WHITE\n                    self._lastPai = self._paiSprites[row][currentX]\n                    self._lastPai.color = cc.Color.GRAY\n                    if (self.coward) {\n                        for (var i = 0; i < 4; i++) {\n                            var index = self._pais[self._lastPai.getComponent('Pai').type * 4 + i]\n                            if (index != null) {\n                                self._paiSprites[index.x][index.y].color = cc.Color.GRAY\n                            }\n                        }\n                    }\n                } else {\n                    for (var j = self.moveStart; j <= self.moveEnd; j++) {\n                        self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\n                        self._paiSprites[row][j].zIndex = 0\n                    }\n                }\n            } else if (delta < 0) {\n                for (var j = self.moveStart + delta; j <= self.moveEnd; j++) {\n                    if (j > self.moveEnd + delta && row != self.rows - 1 && row != 0) {\n                        var highX = row + 1\n                        while (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type === -1) {\n                            highX++\n                        }\n                        var lowX = row - 1\n                        while (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === -1) {\n                            lowX--\n                        }\n                        //cc.log('lowX: ' + lowX)\n                        //cc.log('highX: ' + highX + \", j: \" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\n                        //cc.log('lowX: ' + lowX + \", j: \" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\n                        if (highX < self.rows && lowX >= 0 && self._paiSprites[highX][j].getComponent('Pai').type === self._paiSprites[lowX][j].getComponent('Pai').type\n                            && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\n                            matchFound = true\n                            break\n                        }\n                    }\n                    if (j <= self.moveEnd + delta) {\n                        if (row != self.rows - 1) {\n                            var highX = row + 1\n                            \n                            while (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type === -1) {\n                                cc.log(highX.toString() + \", \" + j);\n                                highX++\n                            }\n                            //cc.log('highX: ' + highX + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\n                            if (highX < self.rows && self._paiSprites[highX][j].getComponent('Pai').type == self._paiSprites[row][j - delta].getComponent('Pai').type\n                                && self._paiSprites[highX][j].getComponent('Pai').type != -1) {\n                                    matchFound = true\n                                    break\n                            }\n                        }\n                        if (row != 0) {\n                            var lowX = row - 1\n                            while (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === -1) {\n                                lowX--\n                            }\n                            //cc.log('lowX: ' + lowX + \", j: \" + \"\" + j)\n                            //cc.log('lowX: ' + lowX + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\n                            if (lowX >= 0 && self._paiSprites[lowX][j].getComponent('Pai').type === self._paiSprites[row][j - delta].getComponent('Pai').type\n                                && self._paiSprites[lowX][j].getComponent('Pai').type != -1) {\n                                matchFound = true\n                                break\n                            }\n                        }\n                    }\n                }\n                cc.log(\"matchFound: \" + matchFound)\n                if (matchFound) {\n                    for (var j = self.moveStart; j <= self.moveEnd; j++) {\n                        //cc.log(\"x: \" + row + \", y: \" + (j + delta) + \", from: \" + self._paiSprites[row][j + delta].getComponent('Pai').type + \", to: \" + self._paiSprites[row][j].getComponent('Pai').type)\n                        var type = self._paiSprites[row][j].getComponent('Pai').type\n                        self._paiSprites[row][j + delta].getComponent('Pai').type = type\n                        self._paiSprites[row][j + delta].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[type]\n                        self._paiSprites[row][j + delta].index = self._paiSprites[row][j].index\n                        self._paiSprites[row][j + delta].width = self.paiWidth\n                        self._paiSprites[row][j + delta].height = self.paiHeight\n                        self._pais[self._paiSprites[row][j].index] = cc.v2(row, j + delta)\n                        if (j > self.moveEnd + delta) {\n                            self._paiSprites[row][j].getComponent('Pai').type = -1\n                            self._paiSprites[row][j].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\n                        }\n                        //cc.log('set row: ' + row + ', j: ' + j + \" to \" + self._paiSprites[row][j].getComponent('Pai').x)\n                        self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\n                        self._paiSprites[row][j].zIndex = 0\n                        self._paiSprites[row][j].width = self.paiWidth\n                        self._paiSprites[row][j].height = self.paiHeight\n                    }\n                    self._lastPai.color = cc.Color.WHITE\n                    self._lastPai = self._paiSprites[row][currentX]\n                    self._lastPai.color = cc.Color.GRAY\n                    if (self.coward) {\n                        for (var i = 0; i < 4; i++) {\n                            var index = self._pais[self._lastPai.getComponent('Pai').type * 4 + i]\n                            if (index != null) {\n                                self._paiSprites[index.x][index.y].color = cc.Color.GRAY\n                            }\n                        }\n                    }\n                } else {\n                    for (var j = self.moveStart; j <= self.moveEnd; j++) {\n                        self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\n                        self._paiSprites[row][j].zIndex = 0\n                    }\n                }\n            } else {\n                for (var j = self.moveStart; j <= self.moveEnd; j++) {\n                    self._paiSprites[row][j].x = self._paiSprites[row][j].getComponent('Pai').y * self.paiWidth - self.paddingLeft\n                    self._paiSprites[row][j].zIndex = 0\n                }\n            }\n        } else if (self.moveDirection === 1) {\n            var row = self._lastPai.getComponent('Pai').x\n            var column = self._lastPai.getComponent('Pai').y\n            var currentY = Math.round((self._lastPai.y + self.paddingTop) / self.paiHeight)\n            var delta = currentY - row\n            var matchFound = false\n            cc.log('row: ' + row)\n            cc.log('currentY: ' + currentY)\n            cc.log('delta: '  + delta)\n            if (delta > 0) {\n                for (var i = self.moveStart; i <= self.moveEnd + delta; i++) {\n                    if (i < self.moveStart + delta && column != self.columns - 1 && column != 0) {\n                        var highY = column + 1\n                        while (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type === -1) {\n                            highY++\n                        }\n                        var lowY = column - 1\n                        while (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === -1) {\n                            lowY--\n                        }\n                        //cc.log('lowY: ' + lowY)\n                        //cc.log('highX: ' + highX + \", j: \" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\n                        //cc.log('lowX: ' + lowX + \", j: \" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\n                        if (lowY >= 0 && highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type === self._paiSprites[i][lowY].getComponent('Pai').type\n                            && self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\n                            matchFound = true\n                            break\n                        }\n                    }\n                    if (i >= self.moveStart + delta) {\n                        if (column != self.columns - 1) {\n                            var highY = column + 1\n                            while (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type === -1) {\n                                highY++\n                            }\n                            //cc.log('highY: ' + highY + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\n                            if (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type == self._paiSprites[i - delta][column].getComponent('Pai').type\n                                && self._paiSprites[i][highY].getComponent('Pai').type != -1) {\n                                    matchFound = true\n                                    break\n                            }\n                        }\n                        if (column != 0) {\n                            var lowY = column - 1\n                            while (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === -1) {\n                                lowY--\n                            }\n                            //cc.log('lowY: ' + lowY)\n                            //cc.log('lowX: ' + lowX + \", j: \" + \"\" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\n                            //cc.log('row: ' + row + \", j: \" + j + \", delta\" + delta + \", type: \" + self._paiSprites[row][j - delta].getComponent('Pai').type)\n                            if (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === self._paiSprites[i - delta][column].getComponent('Pai').type\n                                && self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\n                                matchFound = true\n                                break\n                            }\n                        }\n                    }\n                }\n                cc.log(\"matchFound: \" + matchFound)\n                if (matchFound) {\n                    for (var i = self.moveEnd; i >= self.moveStart; i--) {\n                        //cc.log(\"x: \" + i + \", y: \" + (j + delta) + \", from: \" + self._paiSprites[row][j + delta].getComponent('Pai').type + \", to: \" + self._paiSprites[row][j].getComponent('Pai').type)\n                        var type = self._paiSprites[i][column].getComponent('Pai').type\n                        self._paiSprites[i + delta][column].getComponent('Pai').type = type\n                        self._paiSprites[i + delta][column].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[type]\n                        self._paiSprites[i + delta][column].index = self._paiSprites[i][column].index\n                        self._paiSprites[i + delta][column].width = self.paiWidth\n                        self._paiSprites[i + delta][column].height = self.paiHeight\n                        self._pais[self._paiSprites[i][column].index] = cc.v2(i + delta, column)\n                        if (i < self.moveStart + delta) {\n                            self._paiSprites[i][column].getComponent('Pai').type = -1\n                            self._paiSprites[i][column].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\n                        }\n                        //cc.log('set row: ' + row + ', j: ' + j + \" to \" + self._paiSprites[row][j].getComponent('Pai').x)\n                        self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\n                        self._paiSprites[i][column].zIndex = 0\n                        self._paiSprites[i][column].width = self.paiWidth\n                        self._paiSprites[i][column].height = self.paiHeight\n                    }\n                    self._lastPai.color = cc.Color.WHITE\n                    self._lastPai = self._paiSprites[currentY][column]\n                    self._lastPai.color = cc.Color.GRAY\n                    if (self.coward) {\n                        for (var i = 0; i < 4; i++) {\n                            var index = self._pais[self._lastPai.getComponent('Pai').type * 4 + i]\n                            if (index != null) {\n                                self._paiSprites[index.x][index.y].color = cc.Color.GRAY\n                            }\n                        }\n                    }\n                } else {\n                    for (var i = self.moveStart; i <= self.moveEnd; i++) {\n                        self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\n                        self._paiSprites[i][column].zIndex = 0\n                    }\n                }\n            } else if (delta < 0) {\n                for (var i = self.moveStart + delta; i <= self.moveEnd; i++) {\n                    if (i > self.moveEnd + delta && column != self.columns - 1 && column != 0) {\n                        var highY = column + 1\n                        while (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type === -1) {\n                            highY++\n                        }\n                        var lowY = column - 1\n                        while (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === -1) {\n                            lowY--\n                        }\n                        cc.log('i: ' + i + \", highY: \" + highY)\n                        if (highY < self.columns) {\n                            cc.log(self._paiSprites[i][highY].getComponent('Pai').type)\n                        }\n                        cc.log('i: ' + i + \", lowY: \" + lowY)\n                        if (lowY >= 0) {\n                            cc.log(self._paiSprites[i][lowY].getComponent('Pai').type)\n                        }\n                        //cc.log('highX: ' + highX + \", j: \" + j + \", type: \" + self._paiSprites[highX][j].getComponent('Pai').type)\n                        //cc.log('lowX: ' + lowX + \", j: \" + j + \", type: \" + self._paiSprites[lowX][j].getComponent('Pai').type)\n                        if (highY < self.columns && lowY >= 0 && self._paiSprites[i][highY].getComponent('Pai').type === self._paiSprites[i][lowY].getComponent('Pai').type\n                            && self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\n                            matchFound = true\n                            break\n                        }\n                    }\n                    if (i <= self.moveEnd + delta) {\n                        if (column != self.columns - 1) {\n                            var highY = column + 1\n                            while (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type === -1) {\n                                highY++\n                            }\n                            cc.log('i: ' + i + \", highY: \" + highY + \", type: \" + highY < self.columns ? self._paiSprites[i][highY].getComponent('Pai').type : -1)\n                            cc.log('i: ' + i + \", column: \" + column + \", delta\" + delta + \", type: \" + self._paiSprites[i - delta][column].getComponent('Pai').type)\n                            if (highY < self.columns && self._paiSprites[i][highY].getComponent('Pai').type == self._paiSprites[i - delta][column].getComponent('Pai').type\n                                && self._paiSprites[i][highY].getComponent('Pai').type != -1) {\n                                    matchFound = true\n                                    break\n                            }\n                        }\n                        if (column != 0) {\n                            var lowY = column - 1\n                            while (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === -1) {\n                                lowY--\n                            }\n                            cc.log('i: ' + i + \", lowY: \" + lowY + \", type: \" + lowY >= 0 ? self._paiSprites[i][lowY].getComponent('Pai').type : -1)\n                            cc.log('i: ' + i + \", column: \" + column + \", delta\" + delta + \", type: \" + self._paiSprites[i - delta][column].getComponent('Pai').type)\n                            if (lowY >= 0 && self._paiSprites[i][lowY].getComponent('Pai').type === self._paiSprites[i - delta][column].getComponent('Pai').type\n                                && self._paiSprites[i][lowY].getComponent('Pai').type != -1) {\n                                matchFound = true\n                                break\n                            }\n                        }\n                    }\n                }\n                cc.log(\"matchFound: \" + matchFound)\n                if (matchFound) {\n                    for (var i = self.moveStart; i <= self.moveEnd; i++) {\n                        //cc.log(\"x: \" + row + \", y: \" + (j + delta) + \", from: \" + self._paiSprites[row][j + delta].getComponent('Pai').type + \", to: \" + self._paiSprites[row][j].getComponent('Pai').type)\n                        var type = self._paiSprites[i][column].getComponent('Pai').type\n                        self._paiSprites[i + delta][column].getComponent('Pai').type = type\n                        self._paiSprites[i + delta][column].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[type]\n                        self._paiSprites[i + delta][column].index = self._paiSprites[i][column].index\n                        self._paiSprites[i + delta][column].width = self.paiWidth\n                        self._paiSprites[i + delta][column].height = self.paiHeight\n                        self._pais[self._paiSprites[i][column].index] = cc.v2(i + delta, column)\n                        if (i > self.moveEnd + delta) {\n                            self._paiSprites[i][column].getComponent('Pai').type = -1\n                            self._paiSprites[i][column].getComponent(cc.Sprite).spriteFrame = self.spriteFrames[34]\n                        }\n                        //cc.log('set row: ' + row + ', j: ' + j + \" to \" + self._paiSprites[row][j].getComponent('Pai').x)\n                        self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\n                        self._paiSprites[i][column].zIndex = 0\n                        self._paiSprites[i][column].width = self.paiWidth\n                        self._paiSprites[i][column].height = self.paiHeight\n                    }\n                    self._lastPai.color = cc.Color.WHITE\n                    self._lastPai = self._paiSprites[currentY][column]\n                    self._lastPai.color = cc.Color.GRAY\n                    if (self.coward) {\n                        for (var i = 0; i < 4; i++) {\n                            var index = self._pais[self._lastPai.getComponent('Pai').type * 4 + i]\n                            if (index != null) {\n                                self._paiSprites[index.x][index.y].color = cc.Color.GRAY\n                            }\n                        }\n                    }\n                } else {\n                    for (var i = self.moveStart; i <= self.moveEnd; i++) {\n                        self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\n                        self._paiSprites[i][column].zIndex = 0\n                    }\n                }\n            } else {\n                for (var i = self.moveStart; i <= self.moveEnd; i++) {\n                    self._paiSprites[i][column].y = self._paiSprites[i][column].getComponent('Pai').x * self.paiHeight - self.paddingTop\n                    self._paiSprites[i][column].zIndex = 0\n                }\n            }\n        }\n        self.moveDirection = -1\n\n        this.diedGame();\n    },\n    switchPai(x1, y1, x2, y2) {\n        var tempType = this._paiSprites[x1][y1].getComponent('Pai').type;\n        var tempX = this._paiSprites[x1][y1].getComponent('Pai').x;\n        var tempY = this._paiSprites[x1][y1].getComponent('Pai').y;\n\n        var targetType = this._paiSprites[x2][y2].getComponent('Pai').type;\n        var targetX = this._paiSprites[x2][y2].getComponent('Pai').x;\n        var targetY = this._paiSprites[x2][y2].getComponent('Pai').y;\n\n        if (targetType < 0 || tempType < 0) {\n            return;\n        }\n\n        this._paiSprites[x1][y1].getComponent(cc.Sprite).spriteFrame = this.spriteFrames[targetType]\n        this._paiSprites[x1][y1].getComponent('Pai').type = targetType;\n        this._paiSprites[x1][y1].width = this.paiWidth;\n        this._paiSprites[x1][y1].height = this.paiHeight;\n\n\n        this._paiSprites[x2][y2].getComponent(cc.Sprite).spriteFrame = this.spriteFrames[tempType]\n        this._paiSprites[x2][y2].getComponent('Pai').type = tempType;\n        this._paiSprites[x2][y2].width = this.paiWidth;\n        this._paiSprites[x2][y2].height = this.paiHeight;\n\n    },\n    reshuffle() {\n        var indexes = [];\n        for (var i = 0; i < this.rows; i++) {\n            for (var j = 0; j < this.columns; j++) {\n                var pai = this._paiSprites[i][j].getComponent('Pai');\n                if (pai.type >= 0) {\n                    indexes.push({x:i,y:j});\n                }\n            }\n        }\n\n        var array = new Array(indexes.length);\n        var m = array.length, t, index;\n        for (var i = 0; i < m; i++) {\n            array[i] = i\n        }\n\n        while (m) {\n          index = Math.floor(Math.random() * m--);\n\n          // And swap it with the current element.\n          t = array[m];\n          array[m] = array[index];\n          array[index] = t;\n        }\n\n        for (var i = 0; i < array.length ; i++) {\n            var x1 = indexes[i].x;\n            var y1 = indexes[i].y;\n            var x2 = indexes[array[i]].x;\n            var y2 = indexes[array[i]].y;\n            this.switchPai(x1,y1,x2,y2);\n        }\n        \n    },\n    shuffle() {\n        var array = new Array(this.rows * this.columns)\n        var m = array.length, t, index;\n        for (var i = 0; i < this.rows * this.columns; i++) {\n            array[i] = i\n        }\n\n        // While there remain elements to shuffle\n        while (m) {\n          // Pick a remaining element\n          index = Math.floor(Math.random() * m--);\n\n          // And swap it with the current element.\n          t = array[m];\n          array[m] = array[index];\n          array[index] = t;\n        }\n\n        for (var i = 0; i < this.rows; i++) {\n            for (var j = 0; j < this.columns; j++) {\n                var index = i * this.columns + j\n                var type = Math.trunc(array[index] / 4)\n                this._paiSprites[i][j].getComponent(cc.Sprite).spriteFrame = this.spriteFrames[type]\n                this._paiSprites[i][j].getComponent('Pai').type = type\n                this._paiSprites[i][j].getComponent('Pai').x = i\n                this._paiSprites[i][j].getComponent('Pai').y = j\n                this._paiSprites[i][j].width = this.paiWidth\n                this._paiSprites[i][j].height = this.paiHeight\n                this._paiSprites[i][j].index = array[index]\n                cc.log(array[index] + \", \" + i + \", \" + j)\n                this._pais[array[index]] = cc.v2(i, j)\n            }\n        }\n    },\n\n    winSplash () {\n        var init = cc.moveTo(0, cc.v2(Math.random() * this.paiWidth * this.columns - this.paddingLeft, this.paiHeight * this.rows / 2))\n        var start = cc.moveBy(Math.random() / 2, cc.v2(0, -this.paiHeight)).easing(cc.easeCubicActionOut());\n        var scaleUp = cc.scaleTo(Math.random() / 2, 0.8, 0.8)\n        var move = cc.moveBy(Math.random() * 3, cc.v2(0, -this.paiHeight * (this.rows - 2))).easing(cc.easeCubicActionOut());\n        var scaleDown = cc.scaleTo(Math.random() / 2, 0.5, 0.5)\n        var end = cc.moveBy(Math.random() / 2, cc.v2(0, -this.paiHeight))\n        return cc.repeatForever(cc.sequence(init, start, scaleUp, move, scaleDown, end))\n    },\n\n    start () {\n\n    },\n\n    // update (dt) {},\n});\n"]}